	PARAMETER (I1=25,I2=59,L1=6,J1=3,J2=5,JE1=5,M1=10,M2=20)
	COMMON/GEOM/ZX,RX,RSEP1,ZSEP1,RSEP2,ZSEP2,RDOME,PHIDOME,IOUTCASE,
     2		IINCASE,XRING,DELN1,DELN2,EPDIV1,EPDIV2,DELLT1,DELLT2,
     3		YPUMP1,YPUMP2,DELX1,DELX2,PHIRING1,XLPERP1,XLPERP2,XLPAR1,
     4		XLPAR2,IOPTSN,R1,R2,PHITRAN,RINROUT,ZRING,RPUMP1,RPUMP2,
	5		DELPF,GEOM12,GEOM11,GEOM21,GEOM22,HGEOM11,HGEOM12,HGEOM21,
     6		HGEOM22,DELNS1,DELNS2,THETA1,THETA2,CPUMP12,CPUMP22,
     7		CPUMP11,CPUMP21,EPOUT,EPIN,DIN12,DIN22,DIN11,DIN21,DOUT12,
     8		DOUT22,DOUT11,DOUT21,XLWPL1,XLWPL2,XLUP1,XLWPF1,XLWPF2,
     9		XLWSPL,zdome,xdome
	COMMON/CORE/IPFLUX,IBAL,IMOD,FLUXPART,FLUXHEAT,XLPERP,WCON,IOPTSEP
	2			,IOPTOHM,POHMIN,powsol
	COMMON/LHTRAN/OMEGANT(J1),OMEGAT(J1),OMEGATT(J1),OMEGAVVT(J1),
	2		OMEGAVT(J1),OMEGANVT(J1),OMREQ25(J1),OMREQ24(J1),
	3		OMREQ18(J1),OMRESTRONG(M2),OMREWEAKI(M2),OMREWEAKE(M2),
     4		OMREQYZ(J1),OMREQXX(J1),OMREQYY(J1),OMREPAL(J1),
     5		OMEGATE(J1),OMEGATI(J1),XKRE,XKRI,DTE,DTI			
      COMMON/PARAM/B,GAMSHEATH,IZINJECT,FZINJECT,IZINTRIN,FZINTRIN,FHE,
     2  CHIBOHM,FBE,XLPAR,VPLAS,XMASS,XKAPPA,XK,FS,ALB,IOPTGEOM,CHANGE,
     3      AZTRACE,DELNMAX,DELNMIN,DCHIRAT,IOPTRAD,TAURES,PFUSION,ELONG
     4  ,ioptdiv,TAV,CHANGEOUTER,ITFLUX,ITHEAT,ITINIT,FSHEATH,PFUSIONIN,
	5  deld,PFUSCAL,CIMPRAT,AZINJECT,CIMPRATRACE,QZMULTDIV,QZMULTCORE,
	6	BETAGDIIID,PEDFAC,REDKAPPA,fac5,DNRAD,DQPERP,CHIRSOL,SOLNMULT,
	7  SOLTMULT,IOPTPROF,FOUT,FUDGE,REDKAPPA2,TRIANG,ASYMPART,ASYMHEAT,
	8	xenhance,ZDS,ZHGHT,XDSEP,betacorrect
	COMMON/GASNEUT/REFLECT,TW,GAMDIV,GAMMID,XLMID,CZD(I1),
     2               CDIST,GAMPDIV,CMID,F2N,F2NT,F2NV,XNEUTL,
     3               XNEUTSOL,GAMR2PF,GAMR2PL
     	COMMON/WIDTHS/DELN,DEL,DELE,DELV,DELSOL,IOPTSOL,RWALL,IOPTDEL,
	2              DELNV,DELN2V,DELRATNT,DELRATNV,DELNT,DELNS,DELT
	COMMON/ATOM/SVATD,SVATSOL,SVIOND,SVIONSOL,SVTOTD,SVTOTSOL,SVREC,
     2              SVELD,SVCXD,SVELSOL,SVCXSOL,SVRECSOL,SVRECDIV,
	3			  SVATDIV,SVIONDIV,SVRECD,SVELPED,SVCXPED,SVIONPED,
	4			  SVTOTPED,SVTOTBAR,SVATPED,SVATBAR,SVIONBAR
	COMMON/CALCULATED/XND,XNDO,XNSEP,D,XL,ALPHA,TSEP,VSEP,TAUPAR,X1,
     2             XNEL,DQAT,DQRAD,C2,TD,CSD,GAMSOL,ITERN,Q95,HCONF,
     3            COOLFRAC,COOLEAK,COOLRAD,COOLAT,HEATDIVPLT1,FRACPERP,
     4 RDIV,TRDIV,HEATDIVPLT2,DQATDIV,DQATSOL,COOLATDIV,COOLATSOL,
	5	rat1,		  TPED,XNPED,XNODOLD,DQATOLD,DXLDIV,VDIV,FAC1,
	6                  VSOL,TOD,FCRATD,FCRATDIV,GAMOUTPL,GAMOUTPF,
     7				  FCRATSOL,XIONATD,XIONATSOL,XIONATDIV,COOLFRACAT,
	8				  COOLFRACRAD,ITER,TODD,XKD,XKDSOL,GD,DENLIM0,
	9				  FCRATTB,FCRATPED,ITERTD,ITERCOOL,AMASS,ITSTOP,
	1		DQINSOL,DQRATDW,DQRATDP,DQRRECOM
	COMMON/XSECT/SIGLN(L1,L1,I1),SIGTOT(I1),SIGTR(I1),SELBM(L1,L1,I1)
     2      ,SELMAX(L1),SCFCX(L1,I1),SIG0(I1),SIGTR3(I1),SELN(I1),
     3      SCX(I1),SEL(I1),SION(I1),RECOM(I1),
     4      SIGEFF(I1),SELLN(L1,L1,I1),SIGTR5(I1)
     5      ,SIG1(I1),D0(I1),D1(I1),XMFP(I1),SIG2(I1),
     6      SCATBM(L1,L1,JE1),EBEAM(I1),EN(JE1)
	COMMON/XSECTDATA/ELAST(J2,J2),ELASTN(J2),CX(J2,J2),EION(J2,J2),
     2       IOPTLYMAN,REC(J2,J2),TINT(J2),ZNINT(J2),IOPTELN,FREC 	 
	COMMON/NEUT2/BETAG,FPF,FPD,THETA,FMOL,TSOL,XNSOL,XNOSOL,XNBAR,
     2             XNOBAR,TBAR, XNDIV,XNODIV,TDIV,DELTB,DELPED,DELX,
     3             FUELPF,FUELPLIN,FUELMP,DELLT,XLPL,DMAT,DELNIN,DNAT,	
     4             XLPF,RWPF,RWPL,RWDP,DELPUMP,RPUMP,XNOD,DQIN,XNOPED,
     5			 HNSOL,HNDIV,HVSOL,HVDIV,HTSOL,HTDIV,EIONDIV,EIONBAR,
     6		     EIONPED,EIOND,EIONSOL,DENOMND,XNCOLDD,XNCOLDDIV,
	7			 XNCOLDSOL,PUMPSPEED,RMAJOR,XLWSOL,RWSOL,DNSOL,DNDIV,
	8			 PUMPFRACT,IOPTPUMP,PUMPFRACTTOT,TPLAS,XNPLAS,EPDIV,
	9			 XNOSPL,XNOPF,XNOPL,ALPHACORE,ALPHAR,ALPHASEP,VOD,
     1			 XNOPEDXPT,XNOBARXPT,XNOPEDCOLD,XKPED,XKBAR,ALPHASOL,
	2			 XNOPEDCOLDXPT,RRATD,RRATDIV,RRATSOL,RRIOND,RRIONDIV,
	3			 RRIONSOL,DQDIV,DQR,DQSOL,DND,DMSOL,DMDIV,DMR,CUR21,
	4			 CUR32,CUR43,VOPED,VOBAR,VOSOL,GAMOUTSPL,GAMOUTSOL,
	5			 XNOCOLDBAR,DQRION,DQRAT,DQDIVION,DQDIVAT,DQSOLION,
	6			 DQSOLAT,XNOCOLDPED,SPELLET,XNOCOLDSOL,YIONSOL,YIONDIV
     7             ,YIONREC,GAMZEROM,GAMZERO,DIVDEPTH,DNAT1,DNAT2,IMAT,
	8			 HDIS0,HDISP,FEX,IMOL,AD,DNION,FDIS,FDISP,EEX,TSOR,
	9			 GAMDIV2PF,GAMDIV2PL,FIN,FLUXIONIN,FLUXNEUTIN,PDPAT,
	1			 PWALL,PION,FLUXSEPIN,TPEL,EIONPLAS,TPL,TPF,TSPL,FAC6,
	2			 DNIN,DQNIN,ASCATD,TOD2PF,TOD2PL,GPF,GPL,AMU,RECYCLE,
	3			 GEOM1,GEOM2,XPUMP,YPUMP,GAMPUMP,DREC,HGEOM1,
     4			 HGEOM2,XSEP,ANGLE,YIONSOLXPT,YIONTBXPT,YIONPEDXPT,
     5			 FUELMPREAL,SPELLETREAL,YALPHD,XLZRAD,ENHANCE,IZTRACE,
     6			 YIONTB,SVCXBAR,SVELBAR,CPUMP1,CPUMP2,REABSORBD,
     7			 REABSORBDIV,REABSORBSOL,REABSORBCOR,yionrec1,FRACION,
     8			 factorrec,factorion,BMOL0,BMOLP,RNN,FRACWALL,DQION,
	9			 IOPTSOLN,XNSEPEX,XSEPIN,TNSOL,TNSOLA,RXXPT,WALLFRAC, 
	1			 RRXPT,ZXPT,FUELPLOUT,APF1,APL1,APL2,DELPUMP1,DELPUMP2
     2			 ,GAMPUMP1,GAMPUMP2,XNOD1,XNOD2,XNODIV1,XNODIV2,
     3			XNOPF1,XNOPF2,XNOPL1,XNOPL2,DELXREAL,wallmult,HXPT,
     4			iopttheta,thetain     	

	COMMON/PEDBAR/BFIELD,NBAR,NPED,GRADTBAR(j2),GRADTPED,GRADNBAR(j2),
     2	GRADNPED,CHIRCORE(J2),XNU,ZEFF,Z0,DENLIMMP(M2),DENLIMXPT(M2),
     3	CFZINJ,CFZINT,XLT,XLN,CHIBAR,ERAD,VTHET,VPHI,VRAD,XNUBAR,XLQ,
     4	XLE,XLVTHET,IOPTPED,CPHI,XLVPHI,RHOPED,RHOBAR,CURSEPMP,
     5	CSBAR,XNPEDAV,CURSEP,FRACXPT,GRADTPEDIS,XLTBAR,FCOND,CHIRC,
     6	CHIRTB,XNRHOPED,JOPTPED,XLNBAR,JJOPTPED,IOPTGRAD,CHIRMARF,
     7	CBALLOON,DRCORE,CHIRTEMP,RECFRAC,DREDGE,APED,CHIREXP(J2),
     8	TPEDAV,GRADTEBAR(J2),XNPEDEX,XNTBEX,TPEDEX,TTBEX,TTBEXI,
     9	TTBEXE,TPEDEXI,TPEDEXE,TSEPEXI,TSEPEXE,CFZINTTB,CFZINJTB,
     1	GROW1MP(M2),GROW2MP(M2),GROW3MP(M2),GROW1XP(M2),GROW2XP(M2),
     2	GROW3XP(M2),GROW1AV(M2),GROW2AV(M2),GROW3AV(M2),CHIRTBI,
     3	CHIRTBE,IOPTPART,HRAT,DLMARFXPT,DLMARFMP,RATNLINEAV,FAC,BI,
	4	IOPTPEDWIDTH,CPED,C89,H89,CHEI,FION,CHITBE,CHITBI,TESOL,CNE,
	5	XLTEBAR,XLTIBAR,BALP,RXLTIXLTE,xlmhd,CPINCH,VPINCH,DTBI,IOPTLN
     6	,CIE,HEATFRACE,IOPTPINCH,XLNBAR1,XLNBAR2,CPED2,TISOL,TEPED,
	7	TIPED,CPED1,JOPTPED2,fluxheatianom,fluxheateanom,IGRADPED,FI,
	8	XE,XI,C89N, OMEGTI,OMEGTE,OMEGTIN,OMEGTEI,XMARFCAL,IMARFE,
	9	IOPTCONF,PELME,PELMI,ELMINDEXE,ELMINDEXI,WE0,WI0,HINDEXE,
	1	HINDEXI,ALPHE,ALPHI,CC,ISHAPE,TIBAR,TEBAR,FSHAPE,IDRAKE,
	2	SHEARQ,CBALL,FESEP,FISEP,QCRIT,QI,QCRITFIT,CHITBLI,CHITBLE,
	3	QLH,QHL,QRLH,QRHL,SHEAR0,SHEAR,XJBS,GAMN,GAME,GAMI,XNATOM,ASS,
	4	XNUISEPEP,TRIANGAV,CSHEAR,XLMHDWES,XLMHDMIY,BALWES,BALMIY,
     5	SHEARWES, SHEARMIY,XJBSWES, XJBSMIY,BALNOM,PCRIT,IOPTTAUE,
     6	H98,IOPTTRAN,WIDTHN,MODPED,CMHD,CMHDEFF,cmhdmax,ccrit,
     7	WIDTHNX,WIDTHTEX,WIDTHTIX,XLNBARX,presstb,dpdrcrit,
     8	XLTEBARX,XLTIBARX,wtxpt,ioptq95,cmfp,PSEP,

	common/expinterp/DEXP,CHIEXPE,CHIEXPI,xlpexp,deltran,deltap11,
     1	deltap12,deltap2,cmhdex,ccritex3,cmfpex,xlpth1,xlpth2,deltap3,
     2	deltap4,ccritex4,dln_dt,dlnw_dt,wmhd
     
	COMMON/NEUTF/FNO(I2),FNCOLD(I2),XNO(I2),NNEUT
	
	COMMON/TEMP/TE(I2),DLZDT(I2),RHO(I2),ALPHAT,RAD,T0,RSYN,IPROF,
     2      AMINOR,CHIREDGE,FZ1,NZIMP1,DHDT(I2),HEAT,PB(I2),PBEAM,ENBI,
     3      RHOGAUSS,SIGMA,DEN1(J2),JOBNO,FZ2,NZIMP2,PLASMACUR,POHM(I2),
	4	  CURDEN(I2),ZEFFC,DELC,PRAD,PINSEP,FHEAT,FPART,JIT,PFUS(I2),
	5	  HN,PIONCORE	
	COMMON/TDENS/SN,ST,RADN,RADN2,XLZC(I2),XNAV,ALPHAN,XNJ0,TJ0,AP,VP,
     2	  DPERP,DEN2PP(J1),DEN2PM(J1),DEN2MP(J1),DEN2MM(J1),XNEUT(I2)
     3      ,TAUP,RCOEF,ALPHAT1,ALPHAT2,A1,A2,RADMULT,PSYN,TAVMULT,TAUN,
     3      XNC(I2),IOPT,DENOMC,DENOM1,XN0,SORN,FLUXIN,ITERC,XNCTRPED,
     4	  TCTRPED,TAUE,PIMP,PBREM,HOHM,FRACRAD,FRACBREM,FRACIMP,POHMH, 
     5	  TAURATIO,PFUEL,FRACFUEL,FRACATOM,FRACSOL,FRACRADIV,FRACTOT
	COMMON/EDITS/RPARTT,RPARTN,RPARTP,RPARTTC,RPARTC,PUMPFRAC,PUMPRATE
	2      ,FRACPLASDP 
	COMMON/XPT/YXPT,DELXPT,AXPT,FINXPT,ALPHAXPT,ALPHAX,FLUXSEPINXPT,
     2       FLUXNEUTINXPT,FLUXIONINXPT,TXPT,XNXPT,RXPT,TRXPT,YIONXPT,
     3       VOXPT,SVRECXPT,EIONXPT,FNCOLDX(I2),FNOXPT(I2),XNOCOLDBARXPT
     4	  ,XNOCOLDSOLXPT,ALPHASOLXPT,ALPHASEPXPT,CURSEPXPT,XNOXPT(I2),
     5	  ,FCRATSOLXPT,FCRATBARXPT,FCRATPEDXPT   	 

	COMMON/STABDIV/RADDIV,FREQIONREC,FREQATD,FREQIOND,FREQRECD,FREQAT,
	2       XKLL,DFREQATDT,DFREQIONDT,FREQIONE,FREQION,RAD1,FREQATM,
     3	   FREQIONM,CONDUCTI,XMSOL,DFREQATDTM,DFREQIONDTM,DFREQIONDTE,
     4	   DFREQRECDT	 
 
	COMMON/RETEMP/TDPF,TDPL,VCOLD,VCOLDXPT,XNOSOLXPT
	COMMON/THRESHOLD/CHIXPI,CHIXPE,PTHRESHE,PTHRESHI,XKREDGE
 







C         I1 = # PARALLEL MESH INTERVALS MAXIMUM, L1 = MAX # LEGENDRE MOMENTS
C         J1 = # NEUTRAL TEMPERATURE OR DENSITY INTERPOLATION POINTS
C              FOR XSECT DATA
C		J2 = # ION & ELECTRON TEMPERATURE INTERPOLATION POINTS FOR
C		     XSECT DATA


      
	

     

	c----------------------FILE locGeom.inc------------------------------

c/    This file contains declarations for the variables that 
c/    characterize the straightline geometry in the calculation
c/    of the transmission probabilities.

      integer nph_pnts, i_geom
      real L_i, L_j, L_perp, l_mfp, theta_ij, alpha_j
      common /rcgeom/nph_pnts, i_geom, L_i, L_j, L_perp, l_mfp, 
     .    theta_ij, alpha_j
