	SUBROUTINE ATCOOL (ZN,ZNO,ZT)
C	CALCULATES ATOMIC COOLING RATES
	INCLUDE 'SOLDIV.FI'
	RATNENI2D=(1.+ IZINJECT*FZINJECT+4.*FBE+2.*FHE+
     2			IZINTRIN*FZINTRIN)**2
     	CNEUT = 1.
	IF(IOPTELN.EQ.0) CNEUT = 0.
C		HIGH RECYCLING REGION IN FRONT OF DIVERTOR PLATE
	TDD = TD2		
	IF(TDD.LT.1.E-1) TDD = 1.05E-1 
	IF(TDD.GT.1E3) TDD = .95E3
     	XNDD = XND2
 	IF(XND2.GT.1E22) XNDD = 0.95E22
	IF(XND2.LT.1E16) XNDD = 1.1E16
	TND = TDD
	IF(TND.GE.1000) TND = 995.
	CALL INTERP(TDD,TDD,TND,XNDD)
	SVELD = SEL(1)
	SVELDN= SELN(1)
	SVCXD = SCX(1)
	SVATD = SEL(1) + CNEUT*SELN(1)*XNOD/XNDD + SCX(1)
	SVIOND = SION(1) 
	SVRECD = RECOM(1)
	IF(XNDD.LE.1.E21)
     2	EIOND = 17.5 + (5.+37.5/TDD)*LOG10(1.E21/(XNDD))
	iF(XNDD.GT.1.E21)
     2    EIOND = (30.6 - 16.4*EXP(-5.E19/XNDD))*
     3              EXP(5.45/(TDD*EXP((XNDD/1.37E20)**0.26)))
	SAT(1) = XK*EIOND*XNDD*XNOD*SVIOND -XK*FREC*PION*SVRECD +
	1		 1.5*XNDD*XNOD*XK*(TDD)
	RETURN
	END