      subroutine cxrcefits (iz, te_ev, f0, Lzcxr, dLzcxr, zavg)


c///////////////////////////////////////////////////////////////////////
c/                                                                     /
c/    This subroutine calculates the effective cooling rate (Lz) and   /
c/    the average atomic number <Z> for various impurities  assuming   /
c/    corona equilibrium and including the effect of CXR (Charge       /
c/    Exchange Recombination) with neutrals. The results have been     /
c/    parametrized as a function of the neutral fraction, fn0, and     /
c/    assume a neutral  energy of 100 eV.                              /
c/                                                                     /
c/    The fits have been produced with the TableCurve 2D package using /
c/    data from numerical simulations with ADPAK.                      /
c/                                                                     /
c/    Written by John Mandrekas, GIT, 08/27/98                         /
c/    Updated to include Beryllium, 11/19/01                           /
c/    Updated to include Tungsten,  11/20/01                           /
c/                                                                     /
c/    Input and output variables:                                      /
c/    --------------------------                                       /
c/    iz       : atomic number of impurity species (must be 4,6 or 74) /
c/    te_ev    : electron temperature (eV)                             /
c/    f0       : neutral fraction, n_0/n_e                             /
c/    Lzcxr    : Effective cooling rate (erg-cm^3/s)                   /
c/    dLzcxr   : the derivative dLz / dTe                              /
c/    zavg     : local value of <Z>                                    /
c/                                                                     /
c/    Limits:                                                          /
c/    ------                                                           /
c/    f0       : 1.0e-7 <= fn0 <= 0.1                                  /
c/               (1.0e-7 corresponds to "pure" CE, i.e. no CXR)        /
c/    te_ev    :  1-4 eV <= Te <= 100 keV                              /
c/               (different species have different lower Te limits)    /
c/                                                                     /
c///////////////////////////////////////////////////////////////////////
	

      implicit none
      integer iz
      real te_ev, f0, Lzcxr, dLzcxr, zavg
      real delta_t, teplus, lztmp1, lztmp2, ztmp1, ztmp2

c/    Present version of routine is valid only for Carbon, Be and W:
c/    -------------------------------------------------------------
      if ((iz.NE.4).AND.(iz.NE.6).AND.(iz.NE.74)) then
         write (6, 1000)
         return
      endif

c/    For the derivative dLz/dT, a forward difference approximation is used.
c/    The magnitude of delta_t depends on the temperature region:


      delta_t = 1.0
      if ((te_ev.GT.1.0).AND.(te_ev.LE.10.0)) delta_t = 1.0
      if ((te_ev.GT.10.0).AND.(te_ev.LE.100.0)) delta_t = 5.0
      if ((te_ev.GT.100.0).AND.(te_ev.LE.1000.0)) delta_t = 50.0
      if ((te_ev.GT.1000.0).AND.(te_ev.LE.10000.0)) delta_t = 500.0
      if(te_ev.GT.10000.0) delta_t = 5000.00


      teplus = te_ev + delta_t

      if (iz.EQ.4) then
         call berycalc (te_ev, f0, lztmp1, ztmp1)
         call berycalc (teplus, f0, lztmp2, ztmp2)
      else if (iz.EQ.6) then
         call carbcalc (te_ev, f0, lztmp1, ztmp1)
         call carbcalc (teplus, f0, lztmp2, ztmp2)
      else if (iz.EQ.74) then
         call tungcalc (te_ev, f0, lztmp1, ztmp1)
         call tungcalc (teplus, f0, lztmp2, ztmp2)
      endif


      Lzcxr = lztmp1
      zavg = ztmp1
      dLzcxr = (lztmp2 - lztmp1) / delta_t


1000  format (1x, 'Sorry, this element is not supported at this time!')
        
      return
      end


c//////////////////////////////////////////////////////////////////////


      subroutine carbcalc (elecTemp, fn0, Lz_eff, zav)


      implicit none
      logical first
      integer  nfit
      parameter (nfit = 6)
      real elecTemp, fn0, Lz_eff, zav, teev, teevz, gf,
     .   fn0_loc, lfn0
      real nratio(nfit), lratio(nfit)


      double precision logte, logtez, loglz, logLz1, logLz2, avz, avz1,
     .   avz2


      integer i, itp, itm


      data nratio /1.0e-7, 1.0e-5, 1.0e-4, 1.0e-3, 1.0e-2, 0.1/
      data first /.true./
      save first


      if (first) then
         do i = 1, nfit
            lratio(i) = alog(nratio(i))
         enddo
         first = .false.
      endif


c/    Define local values of temperature and fn0
c/    ------------------------------------------
      teev = elecTemp
      teevz = elecTemp
      fn0_loc = fn0


      if (teev.GT.1.0e5) teev = 1.0e5
      if (teevz.GT.1.0e5) teevz = 1.0e5
      if (teevz.LT.4.0) teevz = 4.0
      if (teev.LT.1.0) teev = 1.0
      if (fn0_loc.GT.0.1) fn0_loc = 0.1
      if (fn0_loc.LT.1.0e-7) fn0_loc = 1.0e-7


c/    Carbon fits (logarithmic interpolation in fn0):
c/    ---------------------------------------------
      lfn0 = alog(fn0_loc)
      logte = dble(alog(teev))
      logtez = dble(alog(teevz))
      do i = 1, nfit
        itp = i
        itm = i-1
        if (lratio(i).GT.lfn0) go to 10
      enddo


 10   gf = (lfn0-lratio(itm)) / (lratio(itp) - lratio(itm))


      if (itp.EQ.2) then
         call carbLz1(logte, logLz2)
         call carbz1(logtez, avz2)
         call carbLz0(logte, logLz1)
         call carbz0(logtez, avz1)
      else if (itp.EQ.3) then
         call carbLz2(logte, logLz2)
         call carbz2(logtez, avz2)
         call carbLz1(logte, logLz1)
         call carbz1(logtez, avz1)
      else if (itp.EQ.4) then
         call carbLz3(logte, logLz2)
         call carbz3(logtez, avz2)
         call carbLz2(logte, logLz1)
         call carbz2(logtez, avz1)
      else if (itp.EQ.5) then
         call carbLz4(logte, logLz2)
         call carbz4(logtez, avz2)
         call carbLz3(logte, logLz1)
         call carbz3(logtez, avz1)
      else if (itp.EQ.6) then
         call carbLz5(logte, logLz2)
         call carbz5(logtez, avz2)
         call carbLz4(logte, logLz1)
         call carbz4(logtez, avz1)
      endif


c/    Interpolate:
c/    ------------
      loglz = logLz1 + gf * (logLz2 - logLz1)
      avz = avz1 + gf * (avz2 - avz1)


      zav = avz
      Lz_eff = DEXP(loglz)


      return
      end
*----------------------------------------------------------*
      SUBROUTINE carbLz0 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7908  y=(a+cx+ex^2+gx^3+ix^4)/(1+bx+dx^2+fx^3+hx^4+jx^5) [NL]
***** r2=0.9973636598999668
***** r2adj=0.996610419871386
***** StdErr=0.1367154041642642
***** Fval=1513.254924715438
***** a= -48.05701638008089
***** b= -0.9311158417187738
***** c= 48.47232544012909
***** d= 0.3656227965320152
***** e= -20.54659779544684
***** f= -0.06743874574667866
***** g= 4.093089761996128
***** h= 0.004473947426571898
***** i= -0.3171908150305152
***** j= 8.863516738272812E-05
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-48.05701638008089D0+x*(48.47232544012909D0+
     1x*(-20.54659779544684D0+x*(4.093089761996128D0+
     1x*(-0.3171908150305152D0)))))/
     1(1.0+x*(-0.9311158417187738D0+x*(0.3656227965320152D0+
     1x*(-0.06743874574667866D0+x*(0.004473947426571898D0+
     1x*(8.863516738272812D-05))))))
      RETURN
      END


      SUBROUTINE carbLz1 (xin,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7938 y=(a+cx^(0.5)+ex+gx^(1.5)+ix^2)/(1+bx^(0.5)+dx+fx^(1.5)+hx^2+jx^(2.5)) [NL]
***** r2=0.9968895239336924
***** r2adj=0.996000816486176
***** StdErr=0.1144873830702045
***** Fval=1281.976781280419
***** a= -48.26108976585108
***** b= -2.043534775774002
***** c= 101.276551783295
***** d= 1.578782798322771
***** e= -80.80831571547241
***** f= -0.5359953349251032
***** g= 28.88539317117795
***** h= 0.06233503304876245
***** i= -3.890114608092218
***** j= 0.002021736953803202
*----------------------------------------------------------*
      DOUBLE PRECISION x,y,xin
      x=DSQRT(xin)
      y=(-48.26108976585108D0+x*(101.2765517832950D0+
     1x*(-80.80831571547241D0+x*(28.88539317117795D0+
     1x*(-3.890114608092218D0)))))/
     1(1.0+x*(-2.043534775774002D0+x*(1.578782798322771D0+
     1x*(-0.5359953349251032D0+x*(0.06233503304876245D0+
     1x*(0.002021736953803202D0))))))
      RETURN
      END


      SUBROUTINE carbLz2 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7909  y=(a+cx+ex^2+gx^3+ix^4+kx^5)/(1+bx+dx^2+fx^3+hx^4+jx^5) [NL]
***** r2=0.9938579850794276
***** r2adj=0.9918708626051248
***** StdErr=0.1196539158641109
***** Fval=566.3455710807457
***** a= -48.17363639615012
***** b= -0.725965067360063
***** c= 39.2684785908266
***** d= 0.253036191261172
***** e= -15.04376082452389
***** f= -0.04366080736061199
***** g= 2.805436557906019
***** h= 0.001747278362590292
***** i= -0.1630625622615418
***** j= 0.000302590632235526
***** k= -0.01059672275404548
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-48.17363639615012D0+x*(39.26847859082660D0+
     1x*(-15.04376082452389D0+x*(2.805436557906019D0+
     1x*(-0.1630625622615418D0+x*(-0.01059672275404548D0))))))/
     1(1.0+x*(-0.7259650673600630D0+x*(0.2530361912611720D0+
     1x*(-0.04366080736061199D0+x*(0.001747278362590292D0+
     1x*(0.0003025906322355260D0))))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbLz3 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7061  High Precision Rational Order 5/6
***** r2=0.9960506193010626
***** r2adj=0.9946144808650854
***** StdErr=0.07543339999141367
***** Fval=779.5404264348596
***** a= -48.24612537515503
***** b= -0.5207347962064592
***** c= 30.41150060339372
***** d= 0.1089358849224695
***** e= -8.841711211209292
***** f= -0.005468843185061347
***** g= 1.254339216983393
***** h= -0.002281855004146044
***** i= -0.03186918311272708
***** j= 0.0004031553280906002
***** k= -0.008888205232614435
***** l= -5.218367253639758E-06
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-48.24612537515503D0+x*(30.41150060339372D0+
     1x*(-8.841711211209292D0+x*(1.254339216983393D0+
     1x*(-0.03186918311272708D0+x*(-0.008888205232614435D0))))))/
     1(1.0+x*(-0.5207347962064592D0+x*(0.1089358849224695D0+
     1x*(-0.005468843185061347D0+x*(-0.002281855004146044D0+
     1x*(0.0004031553280906002D0+x*(-5.218367253639758D-06)))))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbLz4 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7909  y=(a+cx+ex^2+gx^3+ix^4+kx^5)/(1+bx+dx^2+fx^3+hx^4+jx^5) [NL]
***** r2=0.9989957178222752
***** r2adj=0.9986708030000702
***** StdErr=0.04189361330602956
***** Fval=3481.576283967687
***** a= -48.25777013600387
***** b= 0.5567080169148271
***** c= -23.79942457816814
***** d= 0.4619018254954098
***** e= -13.7055228158622
***** f= -0.2402113672179129
***** g= 7.676541654386141
***** h= 0.02157379905037086
***** i= -0.552860909378173
***** j= 0.001931163892626394
***** k= -0.09761877736103596
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-48.25777013600387D0+x*(-23.79942457816814D0+
     1x*(-13.70552281586220D0+x*(7.676541654386141D0+
     1x*(-0.5528609093781730D0+x*(-0.09761877736103596D0))))))/
     1(1.0+x*(0.5567080169148271D0+x*(0.4619018254954098D0+
     1x*(-0.2402113672179129D0+x*(0.02157379905037086D0+
     1x*(0.001931163892626394D0))))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbLz5 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7906  y=(a+cx+ex^2+gx^3)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9989175360821982
***** r2adj=0.9986834898297004
***** StdErr=0.04964209328023934
***** Fval=5009.58517572278
***** a= -48.24935387075439
***** b= -0.08317507482996005
***** c= 4.549147208892025
***** d= 1.003201914244
***** e= -39.34362334869888
***** f= -0.07414863087396985
***** g= 2.743780734934436
***** h= 0.0002760633477668579
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-48.24935387075439D0+x*(4.549147208892025D0+
     1x*(-39.34362334869888D0+x*(2.743780734934436D0))))/
     1(1.0+x*(-0.08317507482996005D0+x*(1.003201914244000D0+
     1x*(-0.07414863087396985D0+x*(0.0002760633477668579D0)))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbz0 (xin,y)
*----------------------------------------------------------*
***** TableCurve E:\workspc\adpak\carbfits\carbz0.for Aug 27, 1998 11:01:40 AM
***** e:\workspc\adpak\carbfits\adfits.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7927  y=(a+cx^2+ex^4+gx^6+ix^8)/(1+bx^2+dx^4+fx^6+hx^8) [NL]
***** r2=0.9937417629173098
***** r2adj=0.9921772036466374
***** StdErr=0.1578680657860305
***** Fval=734.4010130592369
***** a= 0.02026114262530317
***** b= 0.359064815481891
***** c= -1.148926731375311
***** d= 0.2555965909275739
***** e= 1.768198162297531
***** f= -0.02790676715935333
***** g= -0.1724809599454494
***** h= 0.0007812948463679949
***** i= 0.004719593942719677
*----------------------------------------------------------*
      DOUBLE PRECISION x,y,xin
      x=xin*xin
      y=(0.02026114262530317D0+x*(-1.148926731375311D0+
     1x*(1.768198162297531D0+x*(-0.1724809599454494D0+
     1x*(0.004719593942719677D0)))))/
     1(1.0+x*(0.3590648154818910D0+x*(0.2555965909275739D0+
     1x*(-0.02790676715935333D0+x*(0.0007812948463679949D0)))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbz1 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7907  y=(a+cx+ex^2+gx^3+ix^4)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.994025920998759
***** r2adj=0.9925324012484488
***** StdErr=0.155778206945307
***** Fval=769.5529107774339
***** a= 0.01026222217821833
***** b= -0.7704350974113495
***** c= -1.473811840148628
***** d= 0.5187417793147915
***** e= 2.477568600228726
***** f= -0.1558812723194924
***** g= -0.8773871745823321
***** h= 0.01541116331407926
***** i= 0.0904333317056572
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(0.01026222217821833D0+x*(-1.473811840148628D0+
     1x*(2.477568600228726D0+x*(-0.8773871745823321D0+
     1x*(0.09043333170565720D0)))))/
     1(1.0+x*(-0.7704350974113495D0+x*(0.5187417793147915D0+
     1x*(-0.1558812723194924D0+x*(0.01541116331407926D0)))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbz2 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7661  Chebyshev=>Std Rational Order 5/6
***** r2=0.9999225470236776
***** r2adj=0.9998915658331488
***** StdErr=0.01435560859394078
***** Fval=36382.89547306414
***** a= 1.150085465560309
***** b= -1.062937903395777
***** c= -0.5758766256072072
***** d= 0.4056208627931876
***** e= -0.365632998030996
***** f= -0.05757115638526525
***** g= 0.3402142294003078
***** h= 0.001127951727470678
***** i= -0.08403779195242037
***** j= 9.69779181003025E-05
***** k= 0.00683060087600698
***** l= 2.967003324700622E-05
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(1.150085465560309D0+x*(-0.5758766256072072D0+
     1x*(-0.3656329980309960D0+x*(0.3402142294003078D0+
     1x*(-0.08403779195242037D0+x*(0.006830600876006980D0))))))/
     1(1.0+x*(-1.062937903395777D0+x*(0.4056208627931876D0+
     1x*(-0.05757115638526525D0+x*(0.001127951727470678D0+
     1x*(9.697791810030250D-05+x*(2.967003324700622D-05)))))))
      RETURN
      END
*----------------------------------------------------------*
      DOUBLE PRECISION FUNCTION EVALFPOLY(order, x, c)
*----------------------------------------------------------*
      DOUBLE PRECISION x,c(*)
      INTEGER order,i,j
      DOUBLE PRECISION xs,y
      xs=(x-1.098600000000000D0)/(3.315006478672470D0)
      y=c(1)
      i=1
      DO 10 j=2,order+1,2
        y = y + c(j)*DCOS(i*xs)+c(j+1)*DSIN(i*xs)
        i = i+1
  10  CONTINUE
      EVALFPOLY = y
      END



*----------------------------------------------------------*
      SUBROUTINE carbz3 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= Zavg
***** Eqn# 6849  Fourier Series Polynomial 9x2
***** r2=0.9999404202719886
***** r2adj=0.999893252987313
***** StdErr=0.01405947336110686
***** Fval=23310.04497033426
***** a= -4106.955540043388
***** b= -187.9219162236737
***** c= 7643.112264856381
***** d= 6126.84941964411
***** e= 292.6096450064551
***** f= 290.7785724112178
***** g= -4213.37571128678
***** h= -2459.358981918883
***** i= -214.7202496744426
***** j= -122.0213108222742
***** k= 1197.31987712448
***** l= 472.4204367327425
***** m= 52.92594647145775
***** n= 17.10586948202494
***** o= -143.7341121452483
***** p= -30.42186721450204
***** q= -3.848083205675052
***** r= -0.4726006921500227
***** s= 3.432126349260192
*----------------------------------------------------------*
      DOUBLE PRECISION c
      DOUBLE PRECISION x,y
      DOUBLE PRECISION EVALFPOLY
      DIMENSION c(18+1)
      DATA c(1)/-4106.955540043388D0/
      DATA c(2)/-187.9219162236737D0/
      DATA c(3)/7643.112264856381D0/
      DATA c(4)/6126.849419644110D0/
      DATA c(5)/292.6096450064551D0/
      DATA c(6)/290.7785724112178D0/
      DATA c(7)/-4213.375711286780D0/
      DATA c(8)/-2459.358981918883D0/
      DATA c(9)/-214.7202496744426D0/
      DATA c(10)/-122.0213108222742D0/
      DATA c(11)/1197.319877124480D0/
      DATA c(12)/472.4204367327425D0/
      DATA c(13)/52.92594647145775D0/
      DATA c(14)/17.10586948202494D0/
      DATA c(15)/-143.7341121452483D0/
      DATA c(16)/-30.42186721450204D0/
      DATA c(17)/-3.848083205675052D0/
      DATA c(18)/-0.4726006921500227D0/
      DATA c(19)/3.432126349260192D0/
      y=EVALFPOLY(18,x,c)
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbz4 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7909  y=(a+cx+ex^2+gx^3+ix^4+kx^5)/(1+bx+dx^2+fx^3+hx^4+jx^5) [NL]
***** r2=0.999803101653665
***** r2adj=0.9997332344985138
***** StdErr=0.01490012960640292
***** Fval=16248.84101284859
***** a= -3.287591029109985
***** b= 1.282161916015724
***** c= 4.612975618449232
***** d= -0.869450256715035
***** e= -0.8046923893084758
***** f= 0.1770781622352369
***** g= -0.1937518617410102
***** h= -0.01568956808876856
***** i= 0.05077008871067605
***** j= 0.000920988523914053
***** k= -0.001267494968248746
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-3.287591029109985D0+x*(4.612975618449232D0+
     1x*(-0.8046923893084758D0+x*(-0.1937518617410102D0+
     1x*(0.05077008871067605D0+x*(-0.001267494968248746D0))))))/
     1(1.0+x*(1.282161916015724D0+x*(-0.8694502567150350D0+
     1x*(0.1770781622352369D0+x*(-0.01568956808876856D0+
     1x*(0.0009209885239140530D0))))))
      RETURN
      END
*----------------------------------------------------------*
      SUBROUTINE carbz5 (x,y)
*----------------------------------------------------------*
***** X= log_TeV
***** Y= Zavg
***** Eqn# 4112  y=a+bx+cxlnx+d(lnx)^2+e/x
***** r2=0.9998312677672034
***** r2adj=0.9998084661141228
***** StdErr=0.009226818536428552
***** Fval=56292.7241959767
***** a= 41.29242450896716
***** b= -22.56309170922901
***** c= 4.436612588718413
***** d= 16.25044201190159
***** e= -18.73386754952622
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      DOUBLE PRECISION x1,x2,x3,x4
      x1=x
      x2=x*DLOG(x)
      x3=DLOG(x)*DLOG(x)
      x4=1.0/x
      y=41.29242450896716D0-22.56309170922901D0*x1
     1+4.436612588718413D0*x2+16.25044201190159D0*x3
     1-18.73386754952622D0*x4
      RETURN
      END

c/////////////////// BERYLLIUM ROUTINES ////////////////////////////////

      subroutine berycalc (elecTemp, fn0, Lz_eff, zav)

c/    This routine calls the fitting routines produced by 
c/    TableCurve to calculate the cooling rate and average
c/    Z of Beryllium, by performing a logarithmic interpolation
c/    on fn0, the ratio n0 / ne:

c/    Created by John Mandrekas on 11/19/01 for the FIRE studies

      implicit none
      logical first
      integer  nfit
      parameter (nfit = 6)
      real elecTemp, fn0, Lz_eff, zav, teev, gf, fn0_loc, lfn0
      real nratio(nfit), lratio(nfit)

      double precision logte, loglz, logLz1, logLz2, avz, avz1, avz2

      integer i, itp, itm

      data nratio /1.0e-7, 1.0e-5, 1.0e-4, 1.0e-3, 1.0e-2, 0.1/
      data first /.true./
      save first

      if (first) then
         do i = 1, nfit
            lratio(i) = alog10(nratio(i))
         enddo
         first = .false.
      endif

c/    Define local values of temperature and fn0
c/    ------------------------------------------
      teev = elecTemp
      fn0_loc = fn0

c/    Establish upper and lower limits on temperature and fn0:
c/    -------------------------------------------------------
      if (teev.GT.1.0e5) teev = 1.0e5
      if (teev.LT.3.0) teev = 3.0
      if (fn0_loc.GT.0.1) fn0_loc = 0.1
      if (fn0_loc.LT.1.0e-7) fn0_loc = 1.0e-7


c/    Beryllium fits (logarithmic interpolation in fn0):
c/    -------------------------------------------------
      lfn0 = alog10(fn0_loc)
      logte = dble(alog(teev))
      do i = 1, nfit
        itp = i
        itm = i-1
        if (lratio(i).GT.lfn0) go to 10
      enddo

 10   gf = (lfn0-lratio(itm)) / (lratio(itp) - lratio(itm))

      if (itp.EQ.2) then
         call belz01(logte, logLz2)
         call bez01(logte, avz2)
         call belz00(logte, logLz1)
         call bez00(logte, avz1)
      else if (itp.EQ.3) then
         call belz02(logte, logLz2)
         call bez02(logte, avz2)
         call belz01(logte, logLz1)
         call bez01(logte, avz1)
      else if (itp.EQ.4) then
         call belz03(logte, logLz2)
         call bez03(logte, avz2)
         call belz02(logte, logLz1)
         call bez02(logte, avz1)
      else if (itp.EQ.5) then
         call belz04(logte, logLz2)
         call bez04(logte, avz2)
         call belz03(logte, logLz1)
         call bez03(logte, avz1)
      else if (itp.EQ.6) then
         call belz05(logte, logLz2)
         call bez05(logte, avz2)
         call belz04(logte, logLz1)
         call bez04(logte, avz1)
      endif

c/    Interpolate:
c/    ------------
      loglz = logLz1 + gf * (logLz2 - logLz1)
      avz = avz1 + gf * (avz2 - avz1)

      zav = avz
      Lz_eff = DEXP(loglz)


      return
      end


*----------------------------------------------------------*
      SUBROUTINE belz00 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Befits00.f Nov 14, 2001 4:00:39 PM
***** Befits_00.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7907  y=(a+cx+ex^2+gx^3+ix^4)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9987259313124346
***** r2adj=0.9983983136499177
***** StdErr=0.06022080276007845
***** Fval=3527.491676680174
***** a= -38.96435903430701
***** b= -0.6574072058208236
***** c= 20.69965717032876
***** d= 0.1717908344312678
***** e= -3.923915084826623
***** f= -0.02812347478964454
***** g= 0.6868570907989592
***** h= 0.003728674870950173
***** i= -0.1483446761730444
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-38.96435903430701D0+x*(20.69965717032876D0+
     1x*(-3.923915084826623D0+x*(0.6868570907989592D0+
     1x*(-0.1483446761730444D0)))))/
     1(1.0+x*(-0.6574072058208236D0+x*(0.1717908344312678D0+
     1x*(-0.02812347478964454D0+x*(0.003728674870950173D0)))))
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE bez00 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BefitsZ00.for Nov 14, 2001 4:11:03 PM
***** Befits_00Z.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7665  Chebyshev=>Std Rational Order 7/8
***** r2=0.9999934579848219
***** r2adj=0.9999760126110136
***** StdErr=0.004461246532156996
***** Fval=71333.31259870915
***** a= -136.3556534243656
***** b= 74.81694264094535
***** c= 604.9538695290494
***** d= -114.3875922694985
***** e= -863.6421955104374
***** f= 97.66966338286421
***** g= 680.1595324470262
***** h= -51.74929048262258
***** i= -322.035263989214
***** j= 15.74735283459374
***** k= 89.61433987285484
***** l= -2.452299116994643
***** m= -13.39093856742672
***** n= 0.1414584390075986
***** o= 0.8260075522808287
***** p= 0.001975305154766203
*----------------------------------------------------------*
      DOUBLE PRECISION x,y

      if (x.GE.4.6D0) then
	 y = 4.0D0
         return
      endif

      y=(-136.3556534243656D0+x*(604.9538695290494D0+
     1x*(-863.6421955104374D0+x*(680.1595324470262D0+
     1x*(-322.0352639892140D0+x*(89.61433987285484D0+
     1x*(-13.39093856742672D0+x*(0.8260075522808287D0))))))))/
     1(1.0+x*(74.81694264094535D0+x*(-114.3875922694985D0+
     1x*(97.66966338286421D0+x*(-51.74929048262258D0+
     1x*(15.74735283459374D0+x*(-2.452299116994643D0+
     1x*(0.1414584390075986D0+x*(0.001975305154766203D0)))))))))
      RETURN
      END



*----------------------------------------------------------*
      SUBROUTINE belz01 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BeLzfit01.for Nov 19, 2001 10:32:44 AM
***** E:\codes\adpak\runs\Be\Befits_01.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7907  y=(a+cx+ex^2+gx^3+ix^4)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9956311357885423
***** r2adj=0.9945077135627389
***** StdErr=0.09237478114743643
***** Fval=1025.515990929266
***** a= -38.47554741307788
***** b= -0.5102958641547189
***** c= 14.64734481376244
***** d= 0.08863162771975514
***** e= -0.7633225555100111
***** f= -0.01701703816089927
***** g= 0.3236668251611055
***** h= 0.003834168015681632
***** i= -0.1603153469089513
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-38.47554741307788D0+x*(14.64734481376244D0+
     1x*(-0.7633225555100111D0+x*(0.3236668251611055D0+
     1x*(-0.1603153469089513D0)))))/
     1(1.0+x*(-0.5102958641547189D0+x*(0.08863162771975514D0+
     1x*(-0.01701703816089927D0+x*(0.003834168015681632D0)))))
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE bez01 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Bezfit01.for Nov 19, 2001 11:18:06 AM
***** E:\codes\adpak\runs\Be\Befits_01.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7906  y=(a+cx+ex^2+gx^3)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9995098813119703
***** r2adj=0.9991177863615465
***** StdErr=0.02680732150448401
***** Fval=3204.64904375063
***** a= 3.230801387515638
***** b= -3.17436995171826
***** c= -8.052777960583457
***** d= 1.573543342084804
***** e= 3.849795251813967
***** f= -0.2486005560185516
***** g= -0.5496080698849103
***** h= 0.006764669228433863
*----------------------------------------------------------*
      DOUBLE PRECISION x,y

      if (x.GE.5.7038D0) then
	 y = 4.0
	 return
      endif

      y=(3.230801387515638D0+x*(-8.052777960583457D0+
     1x*(3.849795251813967D0+x*(-0.5496080698849103D0))))/
     1(1.0+x*(-3.174369951718260D0+x*(1.573543342084804D0+
     1x*(-0.2486005560185516D0+x*(0.006764669228433863D0)))))
      RETURN
      END



*----------------------------------------------------------*
      SUBROUTINE belz02 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BeLzfit02.for Nov 19, 2001 1:07:44 PM
***** E:\codes\adpak\runs\Be\Befits_02.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7907  y=(a+cx+ex^2+gx^3+ix^4)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9890139492234611
***** r2adj=0.9861889647380653
***** StdErr=0.1189854121353583
***** Fval=405.1103405611314
***** a= -39.66062690531848
***** b= -0.638181202560561
***** c= 23.03767215403504
***** d= 0.1786238874028438
***** e= -6.107015074550334
***** f= -0.03532141492021569
***** g= 1.351164649877513
***** h= 0.004639230609838309
***** i= -0.2019917533767634
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-39.66062690531848D0+x*(23.03767215403504D0+
     1x*(-6.107015074550334D0+x*(1.351164649877513D0+
     1x*(-0.2019917533767634D0)))))/
     1(1.0+x*(-0.6381812025605610D0+x*(0.1786238874028438D0+
     1x*(-0.03532141492021569D0+x*(0.004639230609838309D0)))))
      RETURN
      END



*----------------------------------------------------------*
      SUBROUTINE bez02 (x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Bezfit02.for Nov 19, 2001 1:10:16 PM
***** E:\codes\adpak\runs\Be\Befits_02.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7936  y=(a+cx^(0.5)+ex+gx^(1.5))/(1+bx^(0.5)+dx+fx^(1.5)+hx^2) [NL]
***** r2=0.9996189898433628
***** r2adj=0.9995343209196656
***** StdErr=0.01915009886631721
***** Fval=13867.61030603556
***** a= -83.02645236074409
***** b= 28.44291249762069
***** c= 223.8623654924055
***** d= -29.17586529516473
***** e= -168.1595667583456
***** f= 7.098448055836165
***** g= 39.0309590439632
***** h= 0.2110160448951401
*----------------------------------------------------------*
      DOUBLE PRECISION x0,x,y
      x=DSQRT(x0)
      y=(-83.02645236074409D0+x*(223.8623654924055D0+
     1x*(-168.1595667583456D0+x*(39.03095904396320D0))))/
     1(1.0+x*(28.44291249762069D0+x*(-29.17586529516473D0+
     1x*(7.098448055836165D0+x*(0.2110160448951401D0)))))
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE belz03 (x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BeLzfit03.for Nov 19, 2001 1:13:28 PM
***** E:\codes\adpak\runs\Be\Befits_03.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7937  y=(a+cx^(0.5)+ex+gx^(1.5)+ix^2)/(1+bx^(0.5)+dx+fx^(1.5)+hx^2) [NL]
***** r2=0.998069738484314
***** r2adj=0.9975733855231376
***** StdErr=0.03427027562006661
***** Fval=2326.790326948728
***** a= -42.9547302309587
***** b= -2.408624156709042
***** c= 104.3135925352664
***** d= 2.227788262369944
***** e= -97.1268973734409
***** f= -0.9218710468904806
***** g= 40.38315099257117
***** h= 0.1429949222549963
***** i= -6.283202175218769
*----------------------------------------------------------*
      DOUBLE PRECISION x0,x,y
      x=DSQRT(x0)
      y=(-42.95473023095870D0+x*(104.3135925352664D0+
     1x*(-97.12689737344090D0+x*(40.38315099257117D0+
     1x*(-6.283202175218769D0)))))/
     1(1.0+x*(-2.408624156709042D0+x*(2.227788262369944D0+
     1x*(-0.9218710468904806D0+x*(0.1429949222549963D0)))))
      RETURN
      END


*----------------------------------------------------------*
      DOUBLE PRECISION FUNCTION EVALCRATL(order, x, c)
*----------------------------------------------------------*
      DOUBLE PRECISION x,c(*)
      INTEGER order,i,j,k
      DOUBLE PRECISION xs,n,d,tmp,t2,t1
      xs=(x-6.103075000000000D0)/(5.409925000000000D0)
      i=order
      j=order
      IF (MOD(order,2).EQ.1) THEN
        i=i-1
      ELSE
        j=j-1
      ENDIF
      t2=0.0
      t1=0.0
      DO 10 k=i+1,3,-2
        tmp=t1
        t1=2*xs*t1-t2+c(k)
        t2=tmp
  10  CONTINUE
      n=xs*t1-t2+c(1)
      t2=0.0
      t1=0.0
      DO 20 k=j+1,2,-2
        tmp=t1
        t1=2*xs*t1-t2+c(k)
        t2=tmp
  20  CONTINUE
      d=xs*t1-t2+1.0
      IF (d.EQ.0.0) THEN
        EVALCRATL=0.0
      ELSE
        EVALCRATL=n/d
      ENDIF
      END



*----------------------------------------------------------*
      SUBROUTINE bez03 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Bezfit03.for Nov 19, 2001 1:15:16 PM
***** E:\codes\adpak\runs\Be\Befits_03.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7619  Chebyshev Rational Order 9/10
***** r2=0.9994810263180712
***** r2adj=0.9990485482497972
***** StdErr=0.02699992369891673
***** Fval=2534.052610700318
***** a= 3.613239677578622
***** b= 1.807072773800744
***** c= 6.685980183498011
***** d= 1.580135786777951
***** e= 5.681080175059318
***** f= 1.241312270284596
***** g= 4.56444838534816
***** h= 1.030147608617083
***** i= 3.696836019411706
***** j= 0.7594999248784001
***** k= 2.795027003061392
***** l= 0.5087696658638839
***** m= 1.812632093792489
***** n= 0.2423140073760766
***** o= 0.8861935715118103
***** p= 0.09489723723182478
***** q= 0.307850085859194
***** r= 0.0141336465552864
***** s= 0.04775603160040249
***** t= 0.003061441694267876
*----------------------------------------------------------*
      DOUBLE PRECISION c
      DIMENSION c(19+1)
      DATA c(1)/3.613239677578622D0/
      DATA c(2)/1.807072773800744D0/
      DATA c(3)/6.685980183498011D0/
      DATA c(4)/1.580135786777951D0/
      DATA c(5)/5.681080175059318D0/
      DATA c(6)/1.241312270284596D0/
      DATA c(7)/4.564448385348160D0/
      DATA c(8)/1.030147608617083D0/
      DATA c(9)/3.696836019411706D0/
      DATA c(10)/0.7594999248784001D0/
      DATA c(11)/2.795027003061392D0/
      DATA c(12)/0.5087696658638839D0/
      DATA c(13)/1.812632093792489D0/
      DATA c(14)/0.2423140073760766D0/
      DATA c(15)/0.8861935715118103D0/
      DATA c(16)/0.09489723723182478D0/
      DATA c(17)/0.3078500858591940D0/
      DATA c(18)/0.01413364655528640D0/
      DATA c(19)/0.04775603160040249D0/
      DATA c(20)/0.003061441694267876D0/
      DOUBLE PRECISION x,y
      DOUBLE PRECISION EVALCRATL
      y=EVALCRATL(19,x,c)
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE belz04 (x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BeLzfit04.for Nov 19, 2001 1:17:20 PM
***** E:\codes\adpak\runs\Be\Befits_04.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7937  y=(a+cx^(0.5)+ex+gx^(1.5)+ix^2)/(1+bx^(0.5)+dx+fx^(1.5)+hx^2) [NL]
***** r2=0.9950129726898828
***** r2adj=0.99373059423871
***** StdErr=0.03713104363361134
***** Fval=897.8411584033048
***** a= -584.9998621431202
***** b= 76.86509495987305
***** c= -1741.859848140105
***** d= -59.70771604415612
***** e= 1137.955658396459
***** f= 0.7236305107491316
***** g= 488.1594184167528
***** h= 5.869516768434858
***** i= -315.946458087157
*----------------------------------------------------------*
      DOUBLE PRECISION x0, x,y
      x=DSQRT(x0)
      y=(-584.9998621431202D0+x*(-1741.859848140105D0+
     1x*(1137.955658396459D0+x*(488.1594184167528D0+
     1x*(-315.9464580871570D0)))))/
     1(1.0+x*(76.86509495987305D0+x*(-59.70771604415612D0+
     1x*(0.7236305107491316D0+x*(5.869516768434858D0)))))
      RETURN
      END



*----------------------------------------------------------*
      SUBROUTINE bez04 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Bezfit04.for Nov 19, 2001 1:19:02 PM
***** E:\codes\adpak\runs\Be\Befits_04.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7909  y=(a+cx+ex^2+gx^3+ix^4+kx^5)/(1+bx+dx^2+fx^3+hx^4+jx^5) [NL]
***** r2=0.9997102821609816
***** r2adj=0.9996137095479754
***** StdErr=0.0126770617717985
***** Fval=11732.15626232272
***** a= 0.1499185853961102
***** b= -0.9446961555045996
***** c= -0.08293972114934689
***** d= 0.4684403656575362
***** e= 0.3239966513172604
***** f= -0.1098083182774858
***** g= -0.1452948026652204
***** h= 0.01243346083877235
***** i= 0.0243559301295674
***** j= -0.0004473923653797143
***** k= -0.001075121130574292
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(0.1499185853961102D0+x*(-0.08293972114934689D0+
     1x*(0.3239966513172604D0+x*(-0.1452948026652204D0+
     1x*(0.02435593012956740D0+x*(-0.001075121130574292D0))))))/
     1(1.0+x*(-0.9446961555045996D0+x*(0.4684403656575362D0+
     1x*(-0.1098083182774858D0+x*(0.01243346083877235D0+
     1x*(-0.0004473923653797143D0))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE belz05 (x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\BeLzfit05.for Nov 19, 2001 2:02:33 PM
***** E:\codes\adpak\runs\Be\Befits_05.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7937  y=(a+cx^(0.5)+ex+gx^(1.5)+ix^2)/(1+bx^(0.5)+dx+fx^(1.5)+hx^2) [NL]
***** r2=0.9992504600773808
***** r2adj=0.9990577212401358
***** StdErr=0.01195802115400092
***** Fval=5999.182878258154
***** a= -43.07182435223531
***** b= -1.62766190785647
***** c= 71.50302704726963
***** d= 1.031007944699104
***** e= -46.1706150590918
***** f= -0.3012823632366498
***** g= 13.71261167350819
***** h= 0.03735565379033913
***** i= -1.70375544362307
*----------------------------------------------------------*
      DOUBLE PRECISION x0, x,y
      x=DSQRT(x0)
      y=(-43.07182435223531D0+x*(71.50302704726963D0+
     1x*(-46.17061505909180D0+x*(13.71261167350819D0+
     1x*(-1.703755443623070D0)))))/
     1(1.0+x*(-1.627661907856470D0+x*(1.031007944699104D0+
     1x*(-0.3012823632366498D0+x*(0.03735565379033913D0)))))
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE bez05 (x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\Be\Bezfit05.for Nov 19, 2001 2:15:58 PM
***** E:\codes\adpak\runs\Be\Befits_05.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7906  y=(a+cx+ex^2+gx^3)/(1+bx+dx^2+fx^3+hx^4) [NL]
***** r2=0.9993624240310998
***** r2adj=0.9992207404824554
***** StdErr=0.01207057830527096
***** Fval=8285.042879548946
***** a= -0.03682085572446244
***** b= -0.7902777066273
***** c= 0.01114231922220012
***** d= 0.3461146793277199
***** e= 0.1166993569636691
***** f= -0.0438234042134501
***** g= 0.002910998492956514
***** h= 0.00264178080066266
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-0.03682085572446244D0+x*(0.01114231922220012D0+
     1x*(0.1166993569636691D0+x*(0.002910998492956514D0))))/
     1(1.0+x*(-0.7902777066273000D0+x*(0.3461146793277199D0+
     1x*(-0.04382340421345010D0+x*(0.002641780800662660D0)))))
      RETURN
      END


c///////////////// TUNGSTEN ROUTINES ///////////////////////////////////

      subroutine tungcalc (elecTemp, fn0, Lz_eff, zav)

c/    This routine calls the fitting routines produced by 
c/    TableCurve to calculate the cooling rate and average
c/    Z of Tungsten (W), by performing a logarithmic interpolation
c/    on fn0, the ratio n0 / ne:

c/    Created by John Mandrekas on 11/19/01 for the FIRE studies

      implicit none
      logical first
      integer  nfit
      parameter (nfit = 6)
      real elecTemp, fn0, Lz_eff, zav, teev, gf, fn0_loc, lfn0
      real nratio(nfit), lratio(nfit)

      double precision logte, loglz, logLz1, logLz2, avz, avz1, avz2

      integer i, itp, itm

      data nratio /1.0e-7, 1.0e-5, 1.0e-4, 1.0e-3, 1.0e-2, 0.1/
      data first /.true./
      save first

      if (first) then
         do i = 1, nfit
            lratio(i) = alog(nratio(i))
         enddo
         first = .false.
      endif

c/    Define local values of temperature and fn0
c/    ------------------------------------------
      teev = elecTemp
      fn0_loc = fn0

c/    Establish upper and lower limits on temperature and fn0:
c/    -------------------------------------------------------
      if (teev.GT.1.0e5) teev = 1.0e5
      if (teev.LT.100.0) teev = 100.0
      if (fn0_loc.GT.0.1) fn0_loc = 0.1
      if (fn0_loc.LT.1.0e-7) fn0_loc = 1.0e-7

c/    Tungsten fits (logarithmic interpolation in fn0):
c/    -------------------------------------------------
      lfn0 = alog(fn0_loc)
      logte = dble(alog(teev))
      do i = 1, nfit
        itp = i
        itm = i-1
        if (lratio(i).GT.lfn0) go to 10
      enddo

 10   gf = (lfn0-lratio(itm)) / (lratio(itp) - lratio(itm))

      if (itp.EQ.2) then
         call wlz01(logte, logLz2)
         call wz01(logte, avz2)
         call wlz00(logte, logLz1)
         call wz00(logte, avz1)
      else if (itp.EQ.3) then
         call wlz02(logte, logLz2)
         call wz02(logte, avz2)
         call wlz01(logte, logLz1)
         call wz01(logte, avz1)
      else if (itp.EQ.4) then
         call wlz03(logte, logLz2)
         call wz03(logte, avz2)
         call wlz02(logte, logLz1)
         call wz02(logte, avz1)
      else if (itp.EQ.5) then
         call wlz04(logte, logLz2)
         call wz04(logte, avz2)
         call wlz03(logte, logLz1)
         call wz03(logte, avz1)
      else if (itp.EQ.6) then
         call wlz05(logte, logLz2)
         call wz05(logte, avz2)
         call wlz04(logte, logLz1)
         call wz04(logte, avz1)
      endif

c/    Interpolate:
c/    ------------
      loglz = logLz1 + gf * (logLz2 - logLz1)
      avz = avz1 + gf * (avz2 - avz1)

      zav = avz
      Lz_eff = DEXP(loglz)


      return
      end
*----------------------------------------------------------*
      SUBROUTINE wlz00(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz00.for Nov 20, 2001 10:43:42 AM
***** E:\codes\adpak\runs\W\Wfits00.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 6007  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8+jx^9+kx^(10)
***** r2=0.9998873236812482
***** r2adj=0.9998098587121062
***** StdErr=0.01452750528645117
***** Fval=15085.76486245588
***** a= -196.063575069162
***** b= -249.9617410959618
***** c= 471.8716907048768
***** d= -291.8029848071908
***** e= 97.40402634139774
***** f= -20.05268341137729
***** g= 2.673272941180941
***** h= -0.2321684832138263
***** i= 0.01271146585332654
***** j= -0.0003990602958837795
***** k= 5.482331536371696E-06
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=-196.0635750691620D0+x*(-249.9617410959618D0+
     1x*(471.8716907048768D0+x*(-291.8029848071908D0+
     1x*(97.40402634139774D0+x*(-20.05268341137729D0+
     1x*(2.673272941180941D0+x*(-0.2321684832138263D0+
     1x*(0.01271146585332654D0+x*(-0.0003990602958837795D0+
     1x*(5.482331536371696D-06))))))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wz00(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz00.for Nov 20, 2001 10:45:35 AM
***** E:\codes\adpak\runs\W\Wfits00.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7658  Chebyshev=>Std Rational Order 4/4
***** r2=0.999837370255141
***** r2adj=0.9997560553827116
***** StdErr=0.310581577311082
***** Fval=14601.34956502585
***** a= 18.91309320783322
***** b= -0.4377771921264392
***** c= -10.3901144013867
***** d= 0.07506558792886064
***** e= 2.2742409918846
***** f= -0.005990591823469095
***** g= -0.2272829983742808
***** h= 0.0001878542002196844
***** i= 0.008591208299610574
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(18.91309320783322D0+x*(-10.39011440138670D0+
     1x*(2.274240991884600D0+x*(-0.2272829983742808D0+
     1x*(0.008591208299610574D0)))))/
     1(1.0+x*(-0.4377771921264392D0+x*(0.07506558792886064D0+
     1x*(-0.005990591823469095D0+x*(0.0001878542002196844D0)))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wlz01(x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz01.for Nov 20, 2001 10:47:25 AM
***** E:\codes\adpak\runs\W\Wfits01.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 6729  y=a+bx^2+cx^4+dx^6+ex^8+fx^(10)+gx^(12)+hx^(14)+ix^(16)+jx^(18)+kx^(20)
***** r2=0.9999150845776768
***** r2adj=0.9998567052248296
***** StdErr=0.007810963123433448
***** Fval=20018.22045130265
***** a= 1.366316739927073
***** b= -6.613821211954287
***** c= 0.4430895431768503
***** d= -0.01677819268523151
***** e= 0.0004051311499848554
***** f= -6.567831046282413E-06
***** g= 7.245484432658092E-08
***** h= -5.364084477021474E-10
***** i= 2.547656496277749E-12
***** j= -7.006707220462429E-15
***** k= 8.476193256747203E-18
*----------------------------------------------------------*
      DOUBLE PRECISION x0,x,y
      x=x0*x0
      y=1.366316739927073D0+x*(-6.613821211954287D0+
     1x*(0.4430895431768503D0+x*(-0.01677819268523151D0+
     1x*(0.0004051311499848554D0+x*(-6.567831046282413D-06+
     1x*(7.245484432658092D-08+x*(-5.364084477021474D-10+
     1x*(2.547656496277749D-12+x*(-7.006707220462429D-15+
     1x*(8.476193256747203D-18))))))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wz01(x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz01.for Nov 20, 2001 10:49:00 AM
***** E:\codes\adpak\runs\W\Wfits01.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 7308  y^2=(a+cx^2+ex^4+gx^6+ix^8)/(1+bx^2+dx^4+fx^6+hx^8+jx^(10))
***** r2=0.9999887112284356
***** r2adj=0.9999820707745744
***** StdErr=0.0693175858989475
***** Fval=177165.19561641
***** a= 362.2844804791838
***** b= -0.03042436013045565
***** c= -31.56165925839326
***** d= 0.0003800646504171532
***** e= 1.188342679012742
***** f= -2.227102119737373E-06
***** g= -0.01697736041634867
***** h= -3.088589780800755E-11
***** i= 8.120515322479124E-05
***** j= 5.456635860340356E-11
*----------------------------------------------------------*
      DOUBLE PRECISION x0,x,y
      x=x0*x0
      y=(362.2844804791838D0+x*(-31.56165925839326D0+
     1x*(1.188342679012742D0+x*(-0.01697736041634867D0+
     1x*(8.120515322479124D-05)))))/
     1(1.0+x*(-0.03042436013045565D0+x*(0.0003800646504171532D0+
     1x*(-2.227102119737373D-06+x*(-3.088589780800755D-11+
     1x*(5.456635860340356D-11))))))
      y=DSQRT(y)
      RETURN
      END



*----------------------------------------------------------*
      SUBROUTINE wlz02(x0,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz02.for Nov 20, 2001 10:50:48 AM
***** E:\codes\adpak\runs\W\Wfits02.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 6404  y=a+blnx+c/lnx+d(lnx)^2+e/(lnx)^2+f(lnx)^3+g/(lnx)^3+h(lnx)^4
***** r2=0.9996990417639542
***** r2adj=0.9995723225066718
***** StdErr=0.006436914131643137
***** Fval=9490.629045398276
***** a= -446250.7413056485
***** b= 244953.8614256985
***** c= 484514.2451921346
***** d= -80075.3438470839
***** e= -290749.6383929994
***** f= 14422.85572711998
***** g= 74494.87802047968
***** h= -1103.721328590574
*----------------------------------------------------------*
      DOUBLE PRECISION x0,x,y
      DOUBLE PRECISION n
      x=DLOG(x0)
      n=1.0/x
      y=x*(244953.8614256985D0+x*(-80075.34384708390D0+
     1x*(14422.85572711998D0+x*(-1103.721328590574D0))))
     1-446250.7413056485D0+n*(484514.2451921346D0+
     1n*(-290749.6383929994D0+n*(74494.87802047968D0)))
      RETURN
      END


*----------------------------------------------------------*
      SUBROUTINE wz02(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz02.for Nov 20, 2001 10:52:10 AM
***** E:\codes\adpak\runs\W\Wfits02.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 6007  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8+jx^9+kx^(10)
***** r2=0.9999961647696768
***** r2adj=0.9999935280488296
***** StdErr=0.02987542126311442
***** Fval=443257.2067079608
***** a= -5216.921947945402
***** b= 7421.9125864841
***** c= -4584.201814228751
***** d= 1629.64799664307
***** e= -370.412309763799
***** f= 56.34680079309146
***** g= -5.812182055582657
***** h= 0.4013332445552825
***** i= -0.0177421292023128
***** j= 0.0004529353487725232
***** k= -5.061444490295869E-06
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=-5216.921947945402D0+x*(7421.912586484100D0+
     1x*(-4584.201814228751D0+x*(1629.647996643070D0+
     1x*(-370.4123097637990D0+x*(56.34680079309146D0+
     1x*(-5.812182055582657D0+x*(0.4013332445552825D0+
     1x*(-0.01774212920231280D0+x*(0.0004529353487725232D0+
     1x*(-5.061444490295869D-06))))))))))
      RETURN
      END


*----------------------------------------------------------*
      DOUBLE PRECISION FUNCTION EVALCRATLW(order, x, c)
*----------------------------------------------------------*
      DOUBLE PRECISION x,c(*)
      INTEGER order,i,j,k
      DOUBLE PRECISION xs,n,d,tmp,t2,t1
      xs=(x-8.059100000000000D0)/(3.453900000000000D0)
      i=order
      j=order
      IF (MOD(order,2).EQ.1) THEN
        i=i-1
      ELSE
        j=j-1
      ENDIF
      t2=0.0
      t1=0.0
      DO 10 k=i+1,3,-2
        tmp=t1
        t1=2*xs*t1-t2+c(k)
        t2=tmp
  10  CONTINUE
      n=xs*t1-t2+c(1)
      t2=0.0
      t1=0.0
      DO 20 k=j+1,2,-2
        tmp=t1
        t1=2*xs*t1-t2+c(k)
        t2=tmp
  20  CONTINUE
      d=xs*t1-t2+1.0
      IF (d.EQ.0.0) THEN
        EVALCRATLW=0.0
      ELSE
        EVALCRATLW=n/d
      ENDIF
      END



*----------------------------------------------------------*
      SUBROUTINE wlz03(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz03.for Nov 20, 2001 10:53:34 AM
***** E:\codes\adpak\runs\W\Wfits03.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7614  Chebyshev Rational Order 7/7
***** r2=0.9999891697747148
***** r2adj=0.9999756319931082
***** StdErr=0.0008570483726307228
***** Fval=85737.95534937135
***** a= -39.58947474886428
***** b= -0.6742006631092026
***** c= 26.85423514808106
***** d= 0.683300995795994
***** e= -27.29053344158296
***** f= -0.658272710453238
***** g= 26.08094315643673
***** h= 0.4409221752908114
***** i= -17.45252339165326
***** j= -0.1404928442446588
***** k= 5.585549561148601
***** l= 0.133058016195033
***** m= -5.274467516334
***** n= -0.04175607587854458
***** o= 1.643441164109376
*----------------------------------------------------------*
      DOUBLE PRECISION c
      DIMENSION c(14+1)
      DATA c(1)/-39.58947474886428D0/
      DATA c(2)/-0.6742006631092026D0/
      DATA c(3)/26.85423514808106D0/
      DATA c(4)/0.6833009957959940D0/
      DATA c(5)/-27.29053344158296D0/
      DATA c(6)/-0.6582727104532380D0/
      DATA c(7)/26.08094315643673D0/
      DATA c(8)/0.4409221752908114D0/
      DATA c(9)/-17.45252339165326D0/
      DATA c(10)/-0.1404928442446588D0/
      DATA c(11)/5.585549561148601D0/
      DATA c(12)/0.1330580161950330D0/
      DATA c(13)/-5.274467516334000D0/
      DATA c(14)/-0.04175607587854458D0/
      DATA c(15)/1.643441164109376D0/
      DOUBLE PRECISION x,y
      DOUBLE PRECISION EVALCRATLW
      y=EVALCRATLW(14,x,c)
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wz03(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz03.for Nov 20, 2001 10:56:08 AM
***** E:\codes\adpak\runs\W\Wfits03.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 6006  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8+jx^9
***** r2=0.9999953290971068
***** r2adj=0.9999925815071696
***** StdErr=0.01815133894880495
***** Fval=428180.7401943386
***** a= -13847.43751426995
***** b= 16481.59616048159
***** c= -8578.860580329765
***** d= 2566.742266224872
***** e= -486.8854232255408
***** f= 60.77384072151175
***** g= -4.994573170560817
***** h= 0.2607131576670184
***** i= -0.00784673888211803
***** j= 0.0001037929900073298
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=-13847.43751426995D0+x*(16481.59616048159D0+
     1x*(-8578.860580329765D0+x*(2566.742266224872D0+
     1x*(-486.8854232255408D0+x*(60.77384072151175D0+
     1x*(-4.994573170560817D0+x*(0.2607131576670184D0+
     1x*(-0.007846738882118030D0+x*(0.0001037929900073298D0)))))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wlz04(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz04.for Nov 20, 2001 10:57:48 AM
***** E:\codes\adpak\runs\W\Wfits04.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 7660  Chebyshev=>Std Rational Order 5/5
***** r2=0.9999754093784866
***** r2adj=0.999958503326196
***** StdErr=0.001386113679955566
***** Fval=69130.34690953721
***** a= -39.92811712578881
***** b= -0.4827358849115794
***** c= 19.4438699524518
***** d= 0.09042151529992374
***** e= -3.689737279787084
***** f= -0.008269909593444509
***** g= 0.3438631495551256
***** h= 0.000383659803948958
***** i= -0.01633080668881753
***** j= -7.615040414254348E-06
***** k= 0.0003312938838122326
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=(-39.92811712578881D0+x*(19.44386995245180D0+
     1x*(-3.689737279787084D0+x*(0.3438631495551256D0+
     1x*(-0.01633080668881753D0+x*(0.0003312938838122326D0))))))/
     1(1.0+x*(-0.4827358849115794D0+x*(0.09042151529992374D0+
     1x*(-0.008269909593444509D0+x*(0.0003836598039489580D0+
     1x*(-7.615040414254348D-06))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wz04(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz04.for Nov 20, 2001 11:01:02 AM
***** E:\codes\adpak\runs\W\Wfits04.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 6006  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8+jx^9
***** r2=0.9999935620359454
***** r2adj=0.9999897749982664
***** StdErr=0.006681294303548378
***** Fval=310655.2175715214
***** a= 1005.46971295547
***** b= -1358.761240991751
***** c= 795.9219734888206
***** d= -263.8262922448306
***** e= 54.61051348602326
***** f= -7.327565355005908
***** g= 0.6386157059468802
***** h= -0.03494994406408774
***** i= 0.001092764733737223
***** j= -1.490855120647602E-05
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=1005.469712955470D0+x*(-1358.761240991751D0+
     1x*(795.9219734888206D0+x*(-263.8262922448306D0+
     1x*(54.61051348602326D0+x*(-7.327565355005908D0+
     1x*(0.6386157059468802D0+x*(-0.03494994406408774D0+
     1x*(0.001092764733737223D0+x*(-1.490855120647602D-05)))))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wlz05(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wlz05.for Nov 20, 2001 11:07:31 AM
***** E:\codes\adpak\runs\W\Wfits05.txt
***** X= log_TeV
***** Y= log_Lz
***** Eqn# 6006  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8+jx^9
***** r2=0.9999981419305672
***** r2adj=0.999997048948548
***** StdErr=0.0006074803651110426
***** Fval=1076384.040691879
***** a= 230.370752621697
***** b= -313.9859769681102
***** c= 160.8738146329652
***** d= -47.60860034404914
***** e= 8.984282770117067
***** f= -1.122174377000606
***** g= 0.0928200070687426
***** h= -0.00490499771300392
***** i= 0.0001503349534500593
***** j= -2.037134948031214E-06
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=230.3707526216970D0+x*(-313.9859769681102D0+
     1x*(160.8738146329652D0+x*(-47.60860034404914D0+
     1x*(8.984282770117067D0+x*(-1.122174377000606D0+
     1x*(0.09282000706874260D0+x*(-0.004904997713003920D0+
     1x*(0.0001503349534500593D0+x*(-2.037134948031214D-06)))))))))
      RETURN
      END





*----------------------------------------------------------*
      SUBROUTINE wz05(x,y)
*----------------------------------------------------------*
***** TableCurve E:\codes\adpak\runs\W\wz05.for Nov 20, 2001 11:08:55 AM
***** E:\codes\adpak\runs\W\Wfits05.txt
***** X= log_TeV
***** Y= Zavg
***** Eqn# 6005  y=a+bx+cx^2+dx^3+ex^4+fx^5+gx^6+hx^7+ix^8
***** r2=0.999989781262608
***** r2adj=0.9999846718939122
***** StdErr=0.005722646514602767
***** Fval=232413.8138999546
***** a= -519.1239693893981
***** b= 581.9983153238823
***** c= -279.8977243187133
***** d= 75.91485047210708
***** e= -12.6769481235051
***** f= 1.336059598535898
***** g= -0.08694728171094312
***** h= 0.003199457336220456
***** i= -5.103507488808993E-05
*----------------------------------------------------------*
      DOUBLE PRECISION x,y
      y=-519.1239693893981D0+x*(581.9983153238823D0+
     1x*(-279.8977243187133D0+x*(75.91485047210708D0+
     1x*(-12.67694812350510D0+x*(1.336059598535898D0+
     1x*(-0.08694728171094312D0+x*(0.003199457336220456D0+
     1x*(-5.103507488808993D-05))))))))
      RETURN
      END
