	SUBROUTINE EDITDIV
	INCLUDE 'SOLDIV.FI'
	OPEN(111,FILE='SOLDIV.TXT',STATUS='UNKNOWN') 
100	FORMAT(7E10.3)
c	AP = 39.478*RMAJOR*AMINOR*SQRT((1.+ELONG**2)/2.)
	XNETNEUTIN=CURSEP*(1.-ALPHASEP)*BETAG*XLPERP*RMAJOR*12.566
	AD = BETAG*DELLT*DELN*EPDIV
 	SAT = (XND)*((XND)*SVRECD)

C		FRACTION INPUT HEAT INTO SOL
c	ac = DNAT1
c 	AX = DNAT2
	XK = 1.6E-19
	PD = 2.*XND*TD*XK
	PSOL = 2.*XNSOL*TSEP*XK 
	PDIV = 2.*XNDIV*TDIV*XK
	PPED = 2.*XNPED*TPED*XK
	PTB = 0.5*(PSOL + PPED)
	BPOL =1.257*PLASMACUR/(6.28*AMINOR*SQRT(0.5*(1.+ELONG**2)))
	BETAPOL = PPED/((BPOL**2)/2.514E-6)
	OMEGAPOLI = (1.6E-19*BPOL/XMASS)
	CSPEDI = SQRT(2.*XK*TIPED/XMASS)
	RHOPEDI= CSPEDI/OMEGAPOLI


	TERM = DELE/(FLUXHEAT*XLPERP)
	DQR = DQR*TERM
	DQDIV = DQDIV*TERM
	DQSOL = DQSOL*TERM
	x = dqratdp
	x = dqratdw
	x = dqrrecom
	x = dqsolat
	x = dqdivat

c		divertor heat flux
c	charged particle heat flux to plate
	if(iopttheta.eq.0) 	theta = thetain
	HEATDIVPLAS = GAMSHEATH*XND*CSD*XK*TD*BETAG*sin(theta)
c		reduction of peak heat flux due to transport into private flux
	heatdivplas = heatdivplas*exp(-2.5*deld/(deln*epdiv))
c	neutral particle heat flux to plate	 
	HEATDIVNEUT =  GAMZEROM*XK*TD
c	ionization radiative heat flux to plate
	hion = 1.0 
	heatdivion = hion*dqrion/delns1 
	qdp = HEATDIVPLAS + HEATDIVNEUT + heatdivion
	const = 2.
	if(ioptdiv.eq.2) const = 4.  
c	total power into all sol=powsol
	powsol = powsol*1.e-6
c	L-H power threshold	
	powlh = (2.84/AMASS)*((xnel*1.e-20)**0.58)*(bfield**0.82)*
	2		(rmajor**1.00)*(aminor**0.81)
	  
      qrlh = powsol/powlh	
c		cooling fractions
      COOLFRACRAD = DQRAD*RAT1/DQIN
	COOLFRACAT =  DQAT*RAT1/DQIN
	COOLFRACION = (DQION)*RAT1/DQIN 
	COOLFRAC   =  (DQAT+DQRAD+DQNIN+DQPERP)*RAT1/DQIN
	COOLFRACPERP = DQPERP*RAT1/DQIN
	 IF(IPFLUX.EQ.1) FRACSOL = 1.0 
	FRACRADIV = FRACSOL*COOLFRACRAD
	FRACATDIV = FRACSOL*COOLFRACAT
	FRACPERP = FRACSOL*COOLFRACPERP
	FRACIONDIV = FRACSOL*COOLFRACION
	fracwall = fracsol*(coolfrac-coolfracrad-coolfracion)
	FRACTOT = FRACRAD+FRACSOL*COOLFRAC
C		GREENWALD
	XNGW = PLASMACUR/(3.14*(AMINOR**2))
	RNGW = XNEL/(XNGW*1.E20)	
103   FORMAT (1X,'CENTRAL NE=',E9.3,1X,'EDGE NE=',E9.3,1X,'AVGNE=',
     2	 	E9.3,1X,'ALPN=',F4.2,1X,'LAV=',E9.3)
104	FORMAT (1X,'CENTRAL TE=',E9.3,1X,'EDGE TE=',E9.3,1X,'AVGTE=',
     2		 E9.3,1X,'ALPT=',F4.2,1X,'RNGW=',F7.2)
105	FORMAT (1X,'CORE IMP#1 Z & CONC=',I3.0,F6.4,2X,'IMP#2 Z & CONC=',
     2          I3.0,F6.4,2X,'CORE ZEFF=',F6.4)
106   FORMAT (1X,'CURRENT(MA)=',F5.1,1X,'PHEAT(MW)=',F5.1,1X,
     2       'VP=',F5.2,1X,'AP=',F5.2,1X,'CHIRTBI=',F5.2,1X,
     3		'CHIRTBE=',F5.2)
107	FORMAT (1X,'DENPP=',E8.3,1X,'DENPM=',E8.3,1X,'DENMP=',E8.3,
	2          1X,'DENMM=',E8.3,1X,'CHIREDGE=',E8.3)
108	FORMAT (1X,'# FLUX/NEUTRALS ITERATES =',I5) 
109	FORMAT (1X,'DISRUPT DENSITY LIM ROOTS=',4E9.3,1X,'CHIRCORE=',F6.3)				 
110	FORMAT(1X,'DIV COOLING=',F9.3,2X,'RADIATION=',F9.3,2X,
     2'ATOMIC=',F9.3)  
	
111   FORMAT(1X,'LTE=',F5.3,1X,'LTI=',F5.3,1X,'LN=',F5.3,1X,'DELTB=',
	2F5.3,1x,'widthN=',f5.3,1x,'LMHD=',f5.3,1x,'CMHDEFF=',f5.2)
1110  FORMAT(1X,'LTEX=',F5.3,1X,'LTIX=',F5.3,1X,'LNX=',F5.3,1X,'WIDTHNX=
	2',F5.3,1x,'widthTEX=',f5.3,1x,'WIDTHTIX=',f5.3)
1111	FORMAT(1X,'DEXP=',E9.3,1X,'CHIEXPE=',E9.3,1X,'CHIEXPI=',E9.3)
112	FORMAT(1X,'TB MARFE DLIM=',4E9.3,1X,'MIEXPL='F5.2,1X,'MICALL=',
     2	F5.2) 
113	FORMAT (1X,' DIV IMP#1 Z & CONC=',I3.0,F6.4,2X,'IMP#2 Z & CONC='
     2       ,I3.0,F6.4,2X,'DIV ZEFF=',F4.2)
114	FORMAT(1X,'DISRUPT DENSITY INDEX=',4E9.3,1X,'CHIRCORE=',F6.3) 
115	FORMAT(1X,'ION COOL:',3E9.3,1X,'AT COOL:',3E9.3) 
116	FORMAT(1X,'GRADTBAR=',E8.3,1X,'GRADNBAR=',E8.3,1X,'CHIREXP=',E8.3) 
117	FORMAT(1X,'HEATFLUX=',E9.3,1X,'PARTFLUX=',E9.3,1X,
     2'Qdp=',E9.3,1X,'Psol=',E9.3,1X,'QRLh=',F5.3)
118	FORMAT(1X,'PFFUL=',E7.2,1X,'PLFULOUT=',E7.2,1X,'SOLFUL=',E7.2,1X,
     2'PELFUL=',E7.2,1X,'PLFULIN=',E7.2)
119	FORMAT(1X,'RMAJOR=',F5.3,1X,'AMINOR=',F5.3,1X,'ELONG=',F5.3,1X,'C8
     29=',F5.3,1X,'Q95=',F5.3,1X,'FCOND=',F5.3,1X,'BALP=',F5.3) 
120	FORMAT (1X,'POWFRACS: CORERAD='F5.3,1X,'DIVRAD=',F5.3,1X,'DIVION='
     2,F5.3,1X,'WALL=',F6.3,1X,'TOTAL=',F6.3)  
121	FORMAT (1X,'PARTICLE CONVERGE: TOTS0LDIV=',E10.5,1X,'ATOMSOLDIV=',
     2E10.5,1X,'IONSOLDIV=',E10.5,1X,'TOTCHAM=',E10.5,1X,'IONCORE=',E10.
     35,1X,'PUMPFRAC=',E10.3,1X'IMOL=',I3,1X,'FMOL=',F5.3) 
122	FORMAT (1X,'SOURCEP=',E9.4,1X,'SINKP=',E9.4,1X,'SOURCEN=',E9.4,1X,
     2'SINKN=',E9.4) 
123	FORMAT (1X,'COREPARTSOURCE=',E9.4,1X,'COREPARTSINK=',E9.4,1X,
	2        'NEUTINFLUX=',E9.4)
124	FORMAT (1X,'PUMP DUCT=',F6.3,1X,'PUMP REFLECT=',F6.3,1X,'PUMPRATE=
     2',E10.3,1X,'PUMPFRAC=',F9.6)
125	FORMAT (1X,'Q95=',F6.3,1X,'LSOL=',F6.3,1X,'LDIV=',F6.3,1X,'BETAG='
	2,F6.3,1X,'B=',E10.3,1X,'IMOL=',I2) 
126	FORMAT (1X,'H95P=',F5.3,1X,'TAUE=',F6.3,1X,'HN=',F6.3,1X,'TAUN=',
     2F6.3,1X,'ITER='I4,1X,'pfusion=',e8.3)
127	FORMAT (1X,'FLUXNEUTIN=',E8.3,1X,'FLUXIONIN=',E8.3,1X,'RPUMP='
     2,F4.3,1X,'geom1=',F4.3,1X,'GEOM2=',F4.3)  
129	FORMAT(1X,'RDIVPLT=',F5.3,1X,'RSOL=',F5.3,1X,'RPLEN=',F5.3,1X,'RPR
     2IV=',F5.3,1X,'XSEP=',F6.3,1X,'ENHANCE=,',F5.2,1X,'DELXPT=',F6.3) 
130   FORMAT(1X, 'IMPURITY COMPRESSION RATIOS:TRACE='F8.3,1X,'INJECTED='
     2,F8.3,1X,'IOPTSOLN=',I2)
131	FORMAT(1X,'INPUT CHIREDGE=',F6.3,1X,'INPUT CHIRMARFE=',F6.3,1X,'CA
     2LC CHIREDGE=',F6.3) 
132	FORMAT(1X,'JJOPTPED=',I2,1X,'BOHM=',F4.2,1X,'CBALLOON=',F4.2,1X,'F
     2COND=',F4.2,1X,'APED=',F4.2,1X,'XSEP=',F6.3,1X,'HN=',F5.3) 
	
133	FORMAT(1X,'RAD INSTAB OMEGAS=',6E8.2) 
134	FORMAT (1X,'XPT=',3E8.2,1X,'MID=',3E8.2)
135	FORMAT (1X,'EXP DATA:TEMP=',F6.2,1X,'DENS=',E8.3,1X,'TEMP GRAD=',
     2E8.3,1X,'DENS GRAD=',E8.3)
136	FORMAT(1X,'HNSOL=',F5.3,1X,'HTSOL=',F5.3,1X,'HVSOL=',F5.3,1X,'HNDI
     2V=',F5.3,1X,'HTDIV=',F5.3,1X,'HVDIV=',F5.3,1X,'PEDFAC=',F5.3) 
137	FORMAT (1X,'INTRINSIC RADIATION MULPLIERS: CORE=',F6.3,1X,'DIVERTO
     2R=',F6.3,2X,':CHIRSOL=',F6.3,1X,'FIN=',F5.3)
138	FORMAT(1X,'GROWTHRATE:MID=',3E9.32,1X,'XPT=',3E9.3,1X,'AV=',3E9.3)  
139	FORMAT(1X,'GR NVT:EQ=',1E8.2,1X,'TI=',1E8.2,1X,'TE=',1E8.2,2X,'T 1
     2M=',1E8.2,1X,'2M=',3E8.2)        
140	FORMAT(1X,'REABSORB IONIZATION ENERGY:REC=',F4.2,1X,'DIV=',F4.2,1X
     2,'SOL=',F4.2,1X,'CORE=',F4.2)	      
141	FORMAT(1X,'GR NVT:EQ=',1E8.2,1X,'TI=',1E8.2,1X,'TE=',1E8.2,2X,'AV
	2NEUT CONC. F0=',E8.3,1X,'BI=',F5.2)
142	FORMAT(1X,'XNCTRPED=',F5.2,1X,'TCTRPED=',F5.2,1X,'HRAT=',F5.2,1X,'
	2RXPT=',F6.2,1X,'ZXPT=',F6.2,1X,'TRIANG=',F4.2) 
		
143	FORMAT(1X,'RX=',F5.3,1X,'ZX=',F6.3,1X,'RSEP1=',F5.3,1X,'ZSEP1=',
	2	F6.3,1X,'RSEP2=',F5.3,1X,'ZSEP2=',F6.3)  
144	FORMAT(1X,'RDOME=',F5.3,1X,'PHIDOME=',F5.3,1X,'R1=',F5.3,1X,'R2=',
     2	F5.3,1X,'PHITRAN=',F5.3)
145	FORMAT(1X,'XRING=',F5.3,1X,'ZRING=',F5.3,1X,'YPUMP1=',F5.3,1X,
     2	'YPUMP2=',F5.3,1X,'RPUMP1=',F5.3,1X,'RPUMP2=',F5.3)  
146	FORMAT(1X,'LPL1=',F5.3,1X,'LPL2=',F5.3,1X,'LUP1=',F5.3,1X,'LPF1='
     2	,F5.3,1X,'LPF2=',F5.3)      
147	FORMAT(1X,'RMAJOR=',F5.3,1X,'AMINOR=',F5.3,1X,'ELONG=',F5.3,1X,
     2	'TRIANG=',F5.3,1X,'DELX=',F5.3,1X,'DELXPT=',F5.3) 
153	FORMAT(1X,'VPINCH=',E9.3,1x,'LN1=',F6.3,1X,'BI=',F6.3,1X,'TIPED='
	2	,F8.3,1X,'TEPED=',F8.3)
154	FORMAT(1X,'CPINCH=',E9.3) 
155	FORMAT(1X,'PPED=',E8.2,1X,'TIPED=',F7.2,1X,'TEPED=',F7.2,1X,'q95='
	2,f6.4,1X,'RHOPI=',f5.4,1X,'BETAp=',F6.4)
156	FORMAT(1X,'XJBSWES=',F9.2,1X,'XJBSMIY=',F9.2,1X,'SHEARWES=',F5.2,
     2	1X,'SHEARMIY=',F5.2,1X,'SHEAR0=',F5.2)
157	FORMAT(1X,'Cmhd=',f5.2,1X,'Cmfp=',F5.2,1X,'ccrit=',f5.2,1x,
	2'CHIREDGE=',F5.2)
158	FORMAT(1X,'XLPERP=',F5.2,1X,'DELX1=',F5.2,1X,'XLPAR1=',F5.2,1x,
	2	'xenhance=',F5.3,1x,'deln=',f5.3,1x,'epdiv=',f3.1)                 	
159	FORMAT(1X,'JJOPTPED=',I2,1X,'IOPTPEDWIDTH=',I2,1X,'MODPED=',I2) 
160	format(1x,'cmhd=',f5.3,1x,'cmfp=',f5.3,1x,'ccrit=',f5.3)
161	format(1x,'xlpex=',f5.3,1x,'xlpth1=',f5.3,1x,'xlpth2=',f5.3,1x,
     1	'deltran=',f5.3,1x,'ccritex3=',f4.2,1x,'ccritex4=',f4.2)
162	format(1x,'deltap2=',f5.3,1x,'deltap3=',f5.3,1x,'deltap4=',f5.3,
	1		1x,'cmhdex=',f6.3,1x,'cmfpex=',f6.3) 
163	FORMAT(1X,'CHI-I=', F6.3,1X,'CHI-E=',F6.3,1X,'Pthreshe=',F7.3,
     1		1X,'Pthreshi=',F7.3,1X,'Kr=',F4.1,1x,'heate=',f5.3)  
164	format(1x,'chi-i=',f6.3,1x,'chi-e=',f6.3,1x,'gamsep=',e10.3,1x,
     1	'qisep=',e10.3,1x,'qesep=',e10.3)
165	format(1x,'xnuat=',e10.3,1x,'xnuion=',e10.3,1x,'neutmp='e10.3,1x,
     1	'neutxpt=',e10.3)
166	format(1x,'nion=',e10.3,1x,'ti=',f8.1,1x,'te=',f8.1,1x,'lte=',
     1	f6.3,1x,'lti=',f6.3,1x,'ln=',f6.3)
167	format(1x,'zimpmean=',f6.3,1x,'bthet2=',f6.3,1x,'betap1=',f6.3,1x,
     1	'betap2=',f6.3,1x,'area=',f6.3,1x,'vol=',f6.3)		   
168	FORMAT(1X,'DELQI=',E10.3,1X,'DELQE=',E10.3,1X,'DELGAM=',E10.3,1X,'
     1DWDT=',E10.3,1X,'DNDT=',E10.3,1x,'lz=',e10.3) 
169	format(1x,'alphai=',e10.3,1x,'alphae=',e10.3,1x,'psepe=',f6.3,
	11x,'psepi=',f6.3,1x,'psepthe=',e10.3,1x,'psepthi=',e10.3)     
170	format(1x,'ylamdae=',f6.3,1x,'ylamdai=',f6.3)         	      	     	                 	  
	WRITE(6,119) RMAJOR,AMINOR,ELONG,C89,Q95,FCOND,BALP     
	WRITE (6,106) PLASMACUR,PBEAM,VP,AP,1.E-4*CHIRTBI,1.E-4*CHIRTBE
	WRITE(6,118) FUELPF,FUELPLOUT,FUELMP,SPELLET,FUELPLIN
C	WRITE (6,127) FLUXNEUTIN,FLUXIONIN,RPUMP,GEOM1,GEOM2
	WRITE (6,126) HCONF,TAUE,HN,TAUN,ITERN,pfusion 
	WRITE(6,117) FLUXHEAT,FLUXPART,Qdp,powsol,QRLh
C	WRITE(6,110) COOLFRAC,COOLFRACRAD,COOLFRACAT
	WRITE(6,120) FRACRAD,FRACRADIV,FRACIONDIV,FRACWALL,FRACTOT
C	WRITE(6,115) DQRION/DQIN,DQDIVION/DQIN,DQSOLION/DQIN,
C    2             DQRAT/DQIN,DQDIVAT/DQIN,DQSOLAT/DQIN
	WRITE(6,'(1X,67A)') '  DIVPLT    DIVCHAN    SOL     TRANSBAR  
	2PED    XPTBAR    XPTPED'
	WRITE(6,'(1X,14A)') 'PLASMA DENSITY'  
	WRITE(6,100) XND,XNDIV,XNSol,XNBAR,XNPED,xnsep
C	write(6,100) dnat/(fluxpart*xlperp),yionrec/(dnat*betag),
C	2yiondiv/(dnat*betag),yionsol/(dnat*betag),yionsolxpt/(dnat*betag),
C	3yionrec1/(dnat*betag),dnrad/(dnat*betag)
C	write(6,100) factorrec,svrecd*xnd*xnd,factorion,sviond*xnd*xnod 
	WRITE(6,'(1X,20A)') 'PLASMA TEMPERATURE'
	WRITE(6,100) TD, TDIV,TSol,TBAR,TPED,GAME,GAMI 
C	WRITE(6,'(1X,15A)') 'PLASMA PRESSURE'
	WRITE(6,100)PD,PDIV,PSEP,PTB,PPED,PCRIT
	WRITE(6,'(1X,25A)') 'NEUTRAL DENSITY OUTBOARD'
	WRITE(6,100) XNOD,XNODIV,XNOSOL,XNOBAR,XNOPED,XNOBARXPT,XNOPEDXPT
	XNOAV = (1.-WTXPT)*XNOBAR+WTXPT*XNOBARXPT
	IF(JJOPTPED.EQ.9)  F0 = XNOAV/XNTBEX
	IF(JJOPTPED.EQ.10) F0 = XNOAV/XNBAR
C	WRITE(6,'(1X,20A)') 'COLD NEUTRAL DENSITY'
C	WRITE(6,100) XNCOLDD,XNCOLDDIV,XNCOLDSOL,XNBARCOLD,XNPEDCOLD
C	WRITE(6,'(1X,25A)') 'IONIZATION RATE DENSITY'
C	WRITE(6,100) RRIOND,RRIONDIV,RRIONSOL
C	WRITE(6,'(1X,25A)') 'COLD SCAT+CX RATE DENSITY' 
C	WRITE(6,100) RRATD,RRATDIV,RRATSOL
C	WRITE(6,'(1X,25A)') 'MOMENTUM DISSIPATION'
C	WRITE(6,100) DMR,DMDIV,DMSOL
C	WRITE(6,'(1X,20A)') 'NET IONIZATION SOURCE' 
C	WRITE(6,100) DND,DNDIV,DNSOL
C		MARFE DENSITY LIMIT EDITS


 
	WRITE(6,111) XLTEBAR,XLTIBAR,XLNBAR,DELTB,WIDTHN,XLMHD,CMHDEFF
C	WRITE(6,1110) XLTEBARX,XLTIBARX,XLNBARX,WIDTHNX,WIDTHTEX,WIDTHTIX
	WRITE(6,1111) DEXP,CHIEXPE,CHIEXPI
	write(6,161) xlpexp,xlpth1,xlpth2,deltran,ccritex3,ccritex4
 	write(6,162) deltap2,deltap3,deltap4,cmhdex,cmfpex 
	WRITE(6,163) CHIhmI,CHIhmE,Pthreshe,Pthreshi,XKRedge,fheate
	write(6,169) alphai,alphae,psepe,psepi,psepthe,psepthi
c	write(6,170) ylamdae,ylamdai
	XXX = (TTBEXI*GRADTBAR(4)+TTBEXE*GRADTEBAR(4))/(TTBEXI+TTBEXE) 
C	WRITE (6,135) TTBEX,XNTBEX,1./XXX,1./GRADNBAR(4)
C	WRITE(6,131) CHIREDGE,CHIRMARF,CHIRTEMP
c	*******weight den lim at xpt & midplane 50-50**********************
	XMARAVEXP = 1./(((1./DENLIMXPT(9)) + (1./DENLIMMP(9)))/2.)
	XMARAVCAL = 1./(((1./DENLIMXPT(12)) + (1./DENLIMMP(12)))/2.)
	if(jjoptped.eq.10) 
	2   XMARAVCAL = 1./(((1./DENLIMXPT(14)) + (1./DENLIMMP(14)))/2.)
      
	XMARFINXPT = XNTBEX/DENLIMXPT(9)
	XMARFINAV = XNTBEX/XMARAVEXP
	XMARFCAL  = XNTBEX/XMARAVCAL
	IF(JJOPTPED.EQ.10) XMARFCAL = XNBAR/XMARAVCAL 
	if(jjoptped.eq.9) 
     1 WRITE(6,112) DENLIMXPT(9),DENLIMMP(9),DENLIMXPT(12),DENLIMMP(12),
     2XMARFINxpt,XMARFCAL
	if(jjoptped.eq.10) 
     1 WRITE(6,112) DENLIMXPT(9),DENLIMMP(9),DENLIMXPT(14),DENLIMMP(14),
     2XMARFINxpt,XMARFCAL
	 
C		GROWTH RATES OF RADIAL MODES IN TRANSPORT BARRIER
C	WRITE(6,139) OMRESTRONG(9),OMREWEAKI(9),OMREWEAKE(9),
C    2           GROW1AV(9),GROW2AV(9),GROW3AV(9)
	IF(JJOPTPED.EQ.9)	 
     2	WRITE(6,141) OMRESTRONG(9),OMREWEAKI(9),OMREWEAKE(9),F0,BI
	IF(JJOPTPED.EQ.10)
     2	WRITE(6,141) OMRESTRONG(14),OMREWEAKI(14),OMREWEAKE(14),F0,BI		
C	DISRUPTION DENSITY LIMIT EDITS
C	WRITE (6,'(1X,A34)') 'DENSITY LIMITS FOR N-T INSTABILITY'
c	WRITE (6,109) DEN2PP(1),DEN2PM(1),DEN2MP(1),
c    2		DEN2MM(1),CHIRCORE(1)
C	WRITE (6,109) DEN2PP(2),DEN2PM(2),DEN2MP(2),DEN2MM(2),CHIRCORE(2)
C	WRITE (6,109) DEN2PP(3),DEN2PM(3),DEN2MP(3),DEN2MM(3),CHIRCORE(3)
C	WRITE (6,109) DEN2PP(4),DEN2PM(4),DEN2MP(4),DEN2MM(4),CHIRCORE(4)
	do 754 j=1,4
	if(den1(j).le.0.0) den1(j)=1.e30
754	continue 
	WRITE (6,114) (XNAV/DEN1(J),J=1,4),CHIRCORE(1)

	WRITE (6,103) XN0,XNPED,XNAV,ALPHAN,XNEL
	WRITE (6,104) T0,TPED,TAV,ALPHAT2,RNGW
  	WRITE (6,105) IZINTRIN,FZ1,IZINJECT,FZ2,ZEFFC
 	WRITE (6,113) IZINTRIN,FZINTRIN,IZINJECT,FZINJECT,ZEFF
C	WRITE (6,116) GRADTBAR,GRADNBAR,PUMPFRAC
C	WRITE (6,122) SOURCEP,SINKP,SOURCEN,SINKN	
C 	WRITE (6,121) RPARTT,RPARTN,RPARTP,RPARTTC,RPARTC,PUMPFRAC,IMOL,
C     2IMOL
C 	WRITE (6,130) CIMPRATRACE,CIMPRAT
C	WRITE (6,133) (OMREWEAKI(J), J=1,3),(OMEGAT(J),J=1,3)
	 
C     	write(6,153) vpinch,XLNBAR1,BI,TIPED,TEPED
	ZXD = BETAPOL**0.4 
	WRITE(6,155) PPED,TIPED,TEPED,q95,RHOPEDI,betapol
c	WRITE(6,156) XJBSWES,XJBSMIY,SHEARWES,SHEARMIY,SHEAR0 
      IF(ITSTOP.GT.0) 
     2 WRITE (111,'(1X,39A)')'CALCULATION STOPPED AFTER 100 ITERATIONS'
  	
  	IF(ioptdiv.eq.1.and.IOPTSN.EQ.2) 
     2		WRITE(111,'(1X,20A)')'GEOMETRY=UPPER SN' 
	IF(ioptdiv.eq.1.and.IOPTSN.EQ.1) 
     2		WRITE(111,'(1X,20A)')'GEOMETRY=LOWER SN'
	if(ioptdiv.eq.2) write(111,'(1x,20a)') 'geometry=double null' 
	write(111,159) jjoptped,ioptpedwidth,modped
	WRITE(111,157) CMHD,cmfp, ccrit,CHIREDGE
	WRITE(111,143) RX,ZX,RSEP1,ZSEP1,RSEP2,ZSEP2
	WRITE(111,144) RDOME,PHIDOME,R1,R2,PHITRAN
	WRITE(111,145) XRING,ZRING,YPUMP1,YPUMP2,RPUMP1,RPUMP2
	WRITE(111,146) XLWPL1,XLWPL2,XLUP1,XLWPF1,XLWPF2
	WRITE(111,158) XLPERP,DELX1,XLPAR1,xenhance,deln,epdiv
	WRITE(111,147) RMAJOR,AMINOR,ELONG,TRIANG,DELXreal,DELXPT

	WRITE(111,119) RMAJOR,AMINOR,ELONG,C89,Q95,FCOND,BALP 
	WRITE (111,106)PLASMACUR,PBEAM,VP,AP,1.E-4*CHIRTBI,1.E-4*CHIRTBE
	WRITE (111,125) Q95,XLPERP,XLPAR-XLPERP,BETAG,BFIELD,IMOL
	WRITE(111,118) FUELPF,FUELPLOUT,FUELMP,SPELLET,FUELPLIN
	WRITE (111,127) FLUXNEUTIN,FLUXIONIN,RPUMP,GEOM1,GEOM2
	WRITE (111,126) HCONF,TAUE,HN,TAUN,ITERN,pfusion 
	WRITE(111,117) FLUXHEAT,FLUXPART,Qdp,powsol,QRLh
	WRITE(111,110) COOLFRAC,COOLFRACRAD,COOLFRACAT
	WRITE(111,120) FRACRAD,FRACRADIV,FRACIONDIV,FRACWALL,FRACTOT
	WRITE(111,115) DQRION/DQIN,DQDIVION/DQIN,DQSOLION/DQIN,
     2             DQRAT/DQIN,DQDIVAT/DQIN,DQSOLAT/DQIN
	WRITE(111,'(1X,67A)') '  DIVPLT    DIVCHAN    SOL     TRANSBAR  
	2PED    XPTBAR    XPTPED'

 
	WRITE(111,'(1X,14A)') 'PLASMA DENSITY'  
	WRITE(111,100) XND,XNDIV,XNSol,XNBAR,XNPED,xnsep
	WRITE(111,'(1X,20A)') 'PLASMA TEMPERATURE'
	WRITE(111,100) TD, TDIV,TSol,TBAR,TPED,TESOL,TISOL 
	WRITE(111,'(1X,15A)') 'PLASMA PRESSURE'
	WRITE(111,100)PD,PDIV,PSEP,PTB,PPED,PCRIT
	WRITE(111,'(1X,25A)') 'NEUTRAL DENSITY OUTBOARD'
	WRITE(111,100) XNOD,XNODIV,XNOSOL,XNOBAR,XNOPED,XNOBARXPT,
     2	XNOPEDXPT
	WRITE(111,'(1X,30A)') 'COLD NEUTRAL DENSITY OUTBOARD'
	WRITE(111,100) XNCOLDD,XNCOLDDIV,XNOCOLDSOL,XNOCOLDBAR,XNOPEDCOLD,
     2    XNOCOLDBARXPT,XNOPEDCOLDXPT	 
	WRITE(111,'(1X,25A)') 'IONIZATION RATE DENSITY'
	WRITE(111,100) RRIOND,RRIONDIV,RRIONSOL
	WRITE(111,'(1X,25A)') 'COLD SCAT+CX RATE DENSITY' 
	WRITE(111,100) RRATD,RRATDIV,RRATSOL
	
	WRITE(111,'(1X,25A)') 'MOMENTUM DISSIPATION'
	WRITE(111,100) DMR,DMDIV,DMSOL
	WRITE(111,'(1X,20A)') 'NET IONIZATION SOURCE' 
	WRITE(111,100) DND,DNDIV,DNSOL
C		MARFE DENSITY LIMIT EDITS

C	WRITE(111,131) CHIREDGE,CHIRMARF,CHIRTEMP
C	DO 500 J=1,5
C 	WRITE (111,116) GRADTBAR(J),GRADNBAR(J),CHIREXP(J)
C500	CONTINUE 

C	WRITE(111,112) DENLIMXPT(11),DENLIMXPT(8),DENLIMXPT(9),DENLIMMP(1
C    2             1),DENLIMMP(8),DENLIMMP(9)
C	WRITE (111,'(1X,A51)') 'MARFE DENSITY LIMITS:EXP GRADS & CHIRHEAT,
C	2T=TI--XPT' 
C      WRITE (111,100) (DENLIMXPT(J),J=1,5)
C	WRITE (111,'(1X,A51)') 'MARFE DENSITY LIMITS:EXP GRADS & CHIRHEAT,
C	2T=TI--MID'
C     WRITE (111,100) (DENLIMMP(J),J=1,5)
C	WRITE (111,'(1X,A58)') 'MARFE DENSITY LIMITS:EXP GRADS & CHIRHEAT,
C	2T=(TI+TE)/2--XPT' 
C      WRITE (111,100) (DENLIMXPT(J),J=6,10)
C	WRITE (111,'(1X,A58)') 'MARFE DENSITY LIMITS:EXP GRADS & CHIRHEAT,
C	2T=(TI+TE)/2--MID'
C      WRITE (111,100) (DENLIMMP(J),J=6,10)
C	WRITE (111,'(1X,A36)') 'MARFE DENSITY LIMITS WITH CALC GRADS' 
C	WRITE (111,134) (DENLIMXPT(J),J=11,13),(DENLIMMP(J),J=11,13)
	XXX = (TTBEXI*GRADTBAR(4)+TTBEXE*GRADTEBAR(4))/(TTBEXI+TTBEXE)
	GAMMA = FCOND*FLUXHEAT*XXX/(XNTBEX*TTBEX*XK) 
	WRITE(111,111) XLTEBAR,XLTIBAR,XLNBAR,DELTB,WIDTHN,XLMHD,cmhdeff
	WRITE(111,1110)XLTEBARX,XLTIBARX,XLNBARX,WIDTHNX,WIDTHTEX,WIDTHTIX
	WRITE(111,1111) DEXP,CHIEXPE,CHIEXPI
	write(111,161) xlpexp,xlpth1,xlpth2,deltran,ccritex3,ccritex4
	write(111,162) deltap2,deltap3,deltap4,cmhdex,cmfpex 
	WRITE(111,163) CHIhmI,CHIhmE,Pthreshe,Pthreshi,XKRedge,fheate 
	write(111,169) alphai,alphae,psepe,psepi,psepthe,psepthi
c	write(111,170) ylamdae,ylamdai

	WRITE (111,135) TTBEX,XNTBEX,1./XXX,1./GRADNBAR(4)
	IF(JJOPTPED.EQ.10) XMARFCAL = XNBAR/XMARAVCAL 
	if(jjoptped.eq.9) WRITE(111,112)
     1  DENLIMXPT(9),DENLIMMP(9),DENLIMXPT(12),DENLIMMP(12),
     2XMARFINxpt,XMARFCAL
	if(jjoptped.eq.10) WRITE(111,112) 
     1 DENLIMXPT(9),DENLIMMP(9),DENLIMXPT(14),DENLIMMP(14),
     2XMARFINAV,XMARFCAL

C		GROWTH RATES OF RADIAL MODES IN TRANSPORT BARRIER
	WRITE(111,138) GROW1MP(9),GROW2MP(9),GROW3MP(9),GROW1XP(9),
     2           GROW2XP(9),GROW3XP(9),GROW1AV(9),GROW2AV(9),GROW3AV(9)
      WRITE(111,139) OMRESTRONG(9),OMREWEAKI(9),OMREWEAKE(9),
     2           GROW1AV(9),GROW2AV(9),GROW3AV(9)	
      IF(JJOPTPED.EQ.9)	 
     2	WRITE(111,141) OMRESTRONG(9),OMREWEAKI(9),OMREWEAKE(9),F0,BI
	IF(JJOPTPED.EQ.10)
     2 WRITE(111,141) OMRESTRONG(14),OMREWEAKI(14),OMREWEAKE(14),F0,BI		
       
C		DISRUPTION DENSITY LIMIT EDITS
	WRITE (111,103) XN0,XNPED,XNAV,ALPHAN,XNEL
 	WRITE (111,104) T0,TPED,TAV,ALPHAT2,RNGW
 	WRITE (111,105) IZINTRIN,FZ1,IZINJECT,FZ2,ZEFFC
	WRITE (111,113) IZINTRIN,FZINTRIN,IZINJECT,FZINJECT,ZEFF
	
C     WRITE (111,'(1X,A34)') 'DENSITY LIMITS FOR N-T INSTABILITY'
	WRITE (111,109)DEN2PP(1),DEN2PM(1),DEN2MP(1),
     2		DEN2MM(1),CHIRCORE(1)
 	WRITE (111,109)DEN2PP(2),DEN2PM(2),DEN2MP(2),DEN2MM(2),CHIRCORE(2)
	WRITE (111,109)DEN2PP(3),DEN2PM(3),DEN2MP(3),DEN2MM(3),CHIRCORE(3)
	WRITE (111,109)DEN2PP(4),DEN2PM(4),DEN2MP(4),DEN2MM(4),CHIRCORE(4)

	WRITE (111,114) (XNAV/DEN1(J),J=1,4),CHIRCORE(1)
C      WRITE (111,108) ITERN
	ZXD = BETAPOL**0.4 
	WRITE(111,155) PPED,TIPED,TEPED,q95,RHOPEDI,betapol
	WRITE(111,156) XJBSWES,XJBSMIY,SHEARWES,SHEARMIY,SHEAR0 
 	WRITE (111,121) RPARTT,RPARTN,RPARTP,RPARTTC,RPARTC,PUMPFRAC,IMOL,
     2    FMOL	 
	WRITE (111,124) DELPUMP,RPUMP,PUMPRATE,PUMPFRAC
	WRITE (111,129) RWDP,RWSOL,RWPL,RWPF,XSEP,ENHANCE,DELXPT
	WRITE (111,130) CIMPRATRACE,CIMPRAT,IOPTSOLN
	WRITE (111,132) JJOPTPED,ALB,CBALLOON,FCOND,APED,XSEP,HN
	WRITE (111,136) HNSOL,HTSOL,HVSOL,HNDIV,HTDIV,HVDIV,PEDFAC
	WRITE (111,137) QZMULTCORE,QZMULTDIV,CHIRSOL,FIN 
	WRITE (111,142) XNCTRPED,TCTRPED,HRAT,RX,ZX,TRIANG 
	WRITE (111,140) REABSORBD,REABSORBDIV,REABSORBSOL,REABSORBCOR
C	WRITE (111,'(1X,A35)') 'GROWTH RATE--THERMAL INSTABILITIES'
C	WRITE (111,'(1X,A45)') '  XKR       T ONLY	TI-WEAK   TE-WEAK  TI-	 
C     2TE'
C	DO 600 J = 1,3
C	IF(J.EQ.1) XKR = 1.0
C	IF(J.EQ.2) XKR = 5.0
C	IF(J.EQ.3) XKR = 10.0
C	
C	WRITE (111,100) XKR,OMEGAT(J),OMREWEAKI(J),OMREWEAKE(J),
C     2				OMRESTRONG(J) 
C	WRITE (111,'(1X,A70)') '  OMEGAT    OMEGANT   OMEGATI   OMEGATE  O 
C	2MEGATT   OMEGAVVT   OMEGANVT'
C	WRITE (111,100) OMEGAT(J),OMEGANT(J),OMEGATI(J),OMEGATE(J),
C     2		OMEGATT(J),OMEGAVVT(J),OMEGANVT(J)
C	WRITE (111,'(1X,A69)') '  OMREQ24    OMREQ25  OMREQ18   OMREPAL   
C    2OMREQXX   OMREQYY   OMREQYZ' 
C	WRITE (111,100) OMREQ24(J),OMREQ25(J),OMREQ18(J),OMREPAL(J),
C     2		OMREQXX(J),OMREQYY(J),OMREQYZ(J) 
C	WRITE (111,'(1X,A30)') 'OMRESTRONG OMREWEAKI OMREWEAKE '
C	WRITE (111,100) OMRESTRONG(J),OMREWEAKI(J),OMREWEAKE(J)
C600	CONTINUE	 
C	WRITE (111,100) (XNC(J),J=1,58)
C	WRITE (111,100) (TE(J), J=1,58)
C	WRITE(6,'(1X,A32)') 'PRINT SOLDIV.TXT TO GET PRINTOUT'
	WRITE (111,100) TPF,TPL,TSPL,TDPF,TDPL,TSOL,TDIV
	WRITE (111,100) VCOLD,VCOLDXPT,VOSOL,VOXPT 
	WRITE (111,100) GAMDIV2PF,GAMR2PF,GAMDIV2PL,GAMR2PL,GAMOUTPF,
	2                GAMOUTSPL
	WRITE (111,100) XNO(56),XNO(57),XNO(58),XNOXPT(56),XNOXPT(57),
     2                XNOXPT(58)
      WRITE (111,100) XNOPED,XNOBAR,XNOSOL,XNOPEDXPT,XNOBARXPT,XNOSOLXPT
	WRITE(111,'(1X,65A)') 'XPT NEUTRAL DENSITY: SOL, TB, DELRAD INTERV
     2ALS INSIDE SEPARATRIX'
	write (111,100) xnoxpt(58),xnoxpt(57),xnoxpt(56),xnoxpt(55),
     2				xnoxpt(54),xnoxpt(53),xnoxpt(52),xnoxpt(51),
     3				xnoxpt(50),xnoxpt(49),xnoxpt(48),xnoxpt(47)	  
	IF(IOPTLYMAN.EQ.1) WRITE(111,'(1X,51A)') 'LYMAN SUPPRESSED IONIZATI
     2ON AND RECOMBINATION DATA'  
	IF(IOPTLYMAN.EQ.0) WRITE(111,'(1X,55A)') 'NOT LYMAN SUPPRESSED IONI
     2ZATION AND RECOMBINATION DATA'  
	WRITE(111,'(1X,30A)')'NEUTRAL DENSITIES OUTBOARD & INBOARD'
	WRITE(111,'(1X,70A)')' RECYCLE    DIVCHAN      PF      PL       SP
     1	L'
	WRITE(111,100) XNOD1,XNODIV1,XNOPF1,XNOPL1,XNOSPL
	WRITE(111,100) XNOD2,XNODIV2,XNOPF2,XNOPL2
	IF(IOPTPINCH.EQ.0) WRITE(111,153) VPINCH,XLNBAR1,XLNBAR2,TIPED,
	2									TEPED
	IF(IOPTPINCH.EQ.1) WRITE(111,153) CPINCH
	WRITE(111,155) TIPED,TEPED,HINDEXE,HINDEXI,ELMINDEXE,ELMINDEXI

148	FORMAT(1X,'IOUTCASE=',I2,1X,'IINCASE=',I2,1X,'DELPUMP1=',E10.3,1X,
     2	'DELPUMP2=',E10.3)
149	FORMAT(1X,'YPUMP1=',F5.3,1X,'RPUMP1=',F5.3,1X,'YPUMP2=',F5.3,1X,
     2			'RPUMP2=',F5.3) 
150	FORMAT(1X,'GAMPUMP1=',E10.3,1X,'GAMPUMP2=',E10.3,1X,'PUMPRATE=',
     1	E10.3,1X,'PUMPRAC=',F5.3)
     	WRITE(111,148) IOUTCASE,IINCASE,DELPUMP1,DELPUMP2
	WRITE(111,149) YPUMP1,RPUMP1,YPUMP2,RPUMP2
	WRITE(111,150) GAMPUMP1,GAMPUMP2,PUMPRATE,PUMPFRAC
     	WRITE(111,100) DQRRECOM,DQRATDP,DQRATDW,DQDIVAT,DQSOLAT,DQINSOL,
     2	DQPERP 
151   FORMAT(1X, 'PEDESTAL PARAMETERS: FION=',F6.3,1X,'CPED=',F6.3,1X,
     2'CBAL=',F6.3,1X,'DELTB=',F6.3)
	WRITE(111,151) FION,CPED,CBALLOON,DELTB 
152	FORMAT(1X,'CONFINEMENT DEGRADES: C89=',F6.3,1X,'CHEI=',F6.3,1X,
     2	'H89MAX=',F6.3,1X,'H89=',F6.3)
      WRITE(111,152) C89,CHEI,H89,HCONF
	WRITE(111,156) XJBSWES,XJBSMIY,SHEARWES,SHEARMIY,SHEAR0 
	write(111,164) chiexpi,chiexpe,fluxpart,fluxheati,fluxheate
		xnuatbar = xnocoldbarav*svatbar
	xnuionbar = xnobarav*svionbar
c	special edits for edge rotimptran
	aminoreff =  aminor*sqrt((1.+elong**2)/2.)
	ep = aminoreff/rmajor
	bthet2 = 1.257*plasmacur/(6.28*aminoreff)
	bthet1 = aminoreff*bfield/(q95*rmajor)
	betathet2= 1.6e-19*xnav*tav*2.*1.257e-6/(bthet2**2)	    
 	betathet1= 1.6e-19*xnav*tav*2.*1.257e-6/(bthet1**2)
 	write(111,165) xnuatbar,xnuionbar,xnobar,xnobarxpt
	write(111,166) xnbarx,tibarx,tebarx,xltebarx,xltibarx,xlnbarex
	write(111,167) zimpmean,bthet2,betathet1,betathet2,AP,VP
	WRITE(111,168) DQI1,DQE1,DG1,DW_DT,DN_DT,ylz
     	RETURN
 	END






